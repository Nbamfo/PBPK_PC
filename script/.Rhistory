# Acebutolol-R
pred_ace <- calcKp_Berez(1.4,9.7,0.79,BP=1,type=3,dat_Berez)
pksim_pred_ace <- c(0.16,1.82,2.01,0.99,1.18,1.67,1.67,1.67,1.48,0.82,1.17,1.46,1.24,1.2)
ace <- data.frame(pred = unlist(pred_ace),rep_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
### Weak base ###
# Alprazolam
pred_alp <- calcKp_Berez(2.5,2.4,0.35,BP=1,type=3,dat_Berez)
pksim_pred_alp <- c(7.75,6.06,5.72,1.66,2.39,4.56,4.56,4.56,3.7,0.84,2.41,3.76,2.84,2.43)
alp <- data.frame(pred = unlist(pred_alp),rep_pred = pksim_pred_alp) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Phenobarbital
pred_phen <- calcKp_Berez(0.8,7.35,0.78,BP=0.861,type=2,dat_Berez)
pksim_pred_phen <- c(0.26,0.78,1.09,0.79,0.86,0.94,0.94,0.94,0.92,0.78,0.84,0.88,0.83,0.87)
phen <- data.frame(pred = unlist(pred_phen),rep_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
### Neutral ###
pred_dig <- calcKp_Berez(1.48,0,0.87,BP=1,type=1,dat_Berez)
pksim_pred_dig <- c(1.61,2.24,2.4,1.09,1.34,1.98,1.98,1.98,1.73,0.87,1.32,1.72,1.43,1.36)
dig <- data.frame(pred = unlist(pred_dig),rep_pred = pksim_pred_dig) %>%
mutate(Drug_class = "Neutral")
### Zwitterion
# Ofloxacin
pred_oflo <- calcKp_Berez(-0.4,c(5.97,9.28),0.77,BP=0.92,type=6,dat_Berez)
pksim_pred_oflo <- c(0.15,0.43,0.77,0.72,0.75,0.7,0.7,0.7,0.73,0.76,0.72,0.68,0.69,0.76)
oflo <- data.frame(pred = unlist(pred_oflo),rep_pred = pksim_pred_oflo) %>%
mutate(Drug_class = "Zwitterion")
drug_all_Berez <- rbind(ace,alp,phen,dig,oflo)
# Calculate the Pearson correlation coefficient
corr_coeff_Berez <- round(cor(drug_all_Berez$pred,drug_all_Berez$rep_pred,method='pearson'), digits=2)
corr_coeff_Berez <- paste("italic(r) %~~%", corr_coeff_Berez)
fig2b <- ggplot() +
geom_point(data=drug_all_Berez, aes(x=pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_Berez[1:2])) +
ylim(0,max(drug_all_Berez[1:2])) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("b    Berez") +
th1 +
geom_text(aes(x=max(drug_all_Berez[1:2])*pcc_x, y=max(drug_all_Berez[1:2])*pcc_y, label=corr_coeff_Berez), parse=TRUE)
## Rodgers and Rowland figure ##
### Acids ###
# Cefazolin
pred_RR_a_all <- calcKpu_RR(0.3, 2.3, 0.16, BP=0.55, type=2, dat_RR)
pred_RR_a <- c(pred_RR_a_all[1], pred_RR_a_all[3:8], pred_RR_a_all[10])
rep_RR_a <- c(0.74,1.28,1.23,1.1,0.79,1.52,0.69,1.92)
cef <- data.frame(pred = unlist(pred_RR_a),rep = rep_RR_a) %>%
mutate(Drug_class = "Acid")
# Phenobarbital
pred_RR_a_all2 <- calcKpu_RR(1.6, 7.4, 0.64, BP=0.861, type=2, dat_RR)
pred_RR_a2 <- c(pred_RR_a_all2[3:8], pred_RR_a_all2[10], pred_RR_a_all2[13])
rep_RR_a2 <- c(1.43,0.88,0.97,0.92,1.07,0.79,1.84,1.23)
phen <- data.frame(pred = unlist(pred_RR_a2),rep = rep_RR_a2) %>%
mutate(Drug_class = "Acid")
### Weak bases ###
# Alfentanil
pred_RR_b_all <- calcKpu_RR(2.2, 6.5, 0.11, BP=1, type=3, dat_RR)
pred_RR_b <- c(pred_RR_b_all[2:11], pred_RR_b_all[13])
rep_RR_b <- c(6.3,7.33,3.97,4.24,4.05,5.48,2.88,6.71,10.7,2.7,9.2)
alf <- data.frame(pred = unlist(pred_RR_b),rep = rep_RR_b) %>%
mutate(Drug_class = "Weak base")
### Strong bases ###
# Bisoprolol-R
pred_RR_sb_all <- calcKpu_RR(1.87, 9.4, 0.85, BP=1.36, type=3, dat_RR)
pred_RR_sb <- c(pred_RR_sb_all[1:8], pred_RR_sb_all[10], pred_RR_sb_all[12:13])
rep_RR_sb <- c(3.61,3.36,11,10.4,21.4,19.6,17.2,7.73,6.37,10.8,1.79)
bis <- data.frame(pred = unlist(pred_RR_sb),rep = rep_RR_sb) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
pred_RR_sb_all2 <- calcKpu_RR(1.87, 9.7, 0.79, BP=1.09, type=3, dat_RR)
pred_RR_sb2 <- c(pred_RR_sb_all2[1:8], pred_RR_sb_all2[10], pred_RR_sb_all2[12:13])
rep_RR_sb2 <- c(2.34,2.57,6.45,6.1,11.8,11.0,9.67,4.84,3.85,6.45,0.82)
ace <- data.frame(pred = unlist(pred_RR_sb2),rep = rep_RR_sb2) %>%
mutate(Drug_class = "Strong base")
### Neutral ###
# Ethoxybenzamide
pred_RR_n_all <- calcKpu_RR(0.77, 0, 0.5, BP=1, type=1, dat_RR)
pred_RR_n <- c(pred_RR_n_all[2:5], pred_RR_n_all[7:8], pred_RR_n_all[10:11], pred_RR_n_all[13])
rep_RR_n <- c(1.03,1.1,0.79,0.91,0.86,0.85,1.11,0.78,0.48)
etho <- data.frame(pred = unlist(pred_RR_n),rep = rep_RR_n) %>%
mutate(Drug_class = "Neutral")
### Zwitterions ###
# Enoxacin
pred_eno <- calcKpu_RR(log10(1.26), c(6.1,8.7), 0.66, BP=0.94, type=6, dat_RR)
pred_eno <- c(pred_eno[1], pred_eno[4:8], pred_eno[10:11])
rep_eno <- c(1.74,4.62,9.88,9.04,7.61,3.74,3.16,6.33)
eno <- data.frame(pred = unlist(pred_eno),rep = rep_eno) %>%
mutate(Drug_class = "Zwitterion")
drug_all_RR <- rbind(alf,ace,bis,phen,cef,etho,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_RR <- round(cor(drug_all_RR$pred,drug_all_RR$rep,method='pearson'), digits=2)
corr_coeff_RR <- paste("italic(r) %~~%", corr_coeff_RR)
fig2c <- ggplot() +
geom_point(data=drug_all_RR, aes(x=pred, y=rep, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_RR[1:2])) +
ylim(0,max(drug_all_RR[1:2])) +
xlab("Predicted Kpu") +
ylab("Reported Kpu") +
ggtitle("c    RR") +
th1 +
geom_text(aes(x=max(drug_all_RR[1:2])*pcc_x, y=max(drug_all_RR[1:2])*pcc_y, label=corr_coeff_RR), parse=TRUE)
## Schmitt figure ##
# Using logMA below, could also use logP
### Strong base ###
# Quinidine
pred_quin <- calcKp_Schmitt(2.3, 8.6, 0.33, type=3, dat_Schmitt)
pksim_pred_quin <- c(1.6,22.23,2.85,16.4,12.89,6.22,6.22,6.22,14.85,7.17,1.99,3.26,5.32,5.17)
quin <- data.frame(pred = unlist(pred_quin),pksim_pred = pksim_pred_quin) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
pred_ace <- calcKp_Schmitt(1.4, 9.7, 0.79, type=3, dat_Schmitt)
pksim_pred_ace <- c(0.69,7.38,0.38,5.52,4.51,2.45,2.45,2.45,5.08,2.69,1.15,1.48,1.94,2.13)
ace <- data.frame(pred = unlist(pred_ace),pksim_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
### Weak base ###
# Alprazolam
pred_alp <- calcKp_Schmitt(2.5, 2.4, 0.35, type=3, dat_Schmitt)
pksim_pred_alp <- c(2.83,12.65,102.27,12.9,7.42,8.4,8.4,8.4,9.53,4.96,1.85,6.21,16.68,3.03)
alp <- data.frame(pred = unlist(pred_alp),pksim_pred = pksim_pred_alp) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Phenobarbital
pred_phen <- calcKp_Schmitt(0.8, 7.35, 0.78, type=2, dat_Schmitt)
pksim_pred_phen <- c(0.32,1.08,2.95,1.02,0.87,0.85,0.85,0.85,0.9,0.78,0.68,0.73,0.96,0.72)
phen <- data.frame(pred = unlist(pred_phen),pksim_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
pred_dig <- calcKp_Schmitt(1.48, 0, 0.87, type=1, dat_Schmitt)
pksim_pred_dig <- c(0.9,3.64,24.31,3.64,2.36,2.63,2.63,2.63,2.82,1.77,1.06,2.05,4.38,1.34)
dig <- data.frame(pred = unlist(pred_dig),pksim_pred = pksim_pred_dig) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
pred_oflo <- calcKp_Schmitt(-0.4, c(5.97,9.28), 0.77, type=6, dat_Schmitt)
pksim_pred_oflo <- c(0.23,0.66,0.29,0.6,0.61,0.64,0.64,0.64,0.58,0.6,0.61,0.58,0.46,0.62)
oflo <- data.frame(pred = unlist(pred_oflo),pksim_pred = pksim_pred_oflo) %>%
mutate(Drug_class = "Zwitterion")
drug_all_Schmitt <- rbind(quin,ace,alp,phen,dig,oflo)
# Calculate the Pearson correlation coefficient
corr_coeff_Schmitt <- round(cor(drug_all_Schmitt$pred,drug_all_Schmitt$pksim_pred,method='pearson'), digits=2)
corr_coeff_Schmitt <- paste("italic(r) %~~%", corr_coeff_Schmitt)
fig2d <- ggplot() +
geom_point(data=drug_all_Schmitt, aes(x=pred, y=pksim_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_Schmitt[1:2])) +
ylim(0,max(drug_all_Schmitt[1:2])) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("d    Schmitt") +
th1 +
geom_text(aes(x=max(drug_all_Schmitt[1:2])*pcc_x, y=max(drug_all_Schmitt[1:2])*pcc_y, label=corr_coeff_Schmitt), parse=TRUE)
## PK-Sim standard figure ##
### Strong Base ###
# Acebutolol-R
pred_ace <- calcKp_pksim(1.87, 0.79, dat_pksim)
pksim_pred_ace <- c(16.44,7.2,47.04,6.67,3.9,4.45,4.45,4.45,4.89,1.48,1.65,5.43,6.75,1.83)
ace <- data.frame(pred = unlist(pred_ace),pksim_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
### Weak base ###
# Triazolam
pred_tri <- calcKp_pksim(2.4, 0.28, dat_pksim)
pksim_pred_tri <- c(19.41,8.09,56.39,7.51,4.15,4.79,4.79,4.79,5.36,1.22,1.42,6.03,7.66,1.65)
tri <- data.frame(pred = unlist(pred_tri),pksim_pred = pksim_pred_tri) %>%
mutate(Drug_class = "Weak base")
### Acids ###
# Phenobarbital
pred_phen <- calcKp_pksim(1.6, 0.64, dat_pksim)
pksim_pred_phen <- c(7.3,3.37,20.51,3.13,1.93,2.18,2.18,2.18,2.36,0.89,0.97,2.58,3.13,1.03)
phen <- data.frame(pred = unlist(pred_phen),pksim_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Ethoxybenzamide
pred_etho <- calcKp_pksim(0.77, 0.5, dat_pksim)
pksim_pred_etho <- c(1.06,0.74,2.44,0.68,0.57,0.6,0.6,0.6,0.6,0.46,0.47,0.61,0.64,0.46)
etho <- data.frame(pred = unlist(pred_etho),pksim_pred = pksim_pred_etho) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Enoxacin
pred_eno <- calcKp_pksim(0.100, 0.66, dat_pksim)
pksim_pred_eno <- c(0.56,0.63,0.77,0.59,0.58,0.59,0.59,0.59,0.57,0.56,0.57,0.55,0.52,0.55)
eno <- data.frame(pred = unlist(pred_eno),pksim_pred = pksim_pred_eno) %>%
mutate(Drug_class = "Zwitterion")
drug_all_pksim <- rbind(ace,alp,phen,dig,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_pksim <- round(cor(drug_all_pksim$pred,drug_all_pksim$pksim_pred,method='pearson'), digits=2)
corr_coeff_pksim <- paste("italic(r) %~~%", corr_coeff_pksim)
fig2e <- ggplot() +
geom_point(data=drug_all_pksim, aes(x=pred, y=pksim_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_pksim[1:2])) +
ylim(0,max(drug_all_pksim[1:2])) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("e    PK-Sim") +
th1 +
geom_text(aes(x=max(drug_all_pksim[1:2])*pcc_x, y=max(drug_all_pksim[1:2])*pcc_y, label=corr_coeff_pksim), parse=TRUE)
fig2 <- grid.arrange(fig2a, fig2b, fig2c, fig2d, fig2e, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig2_new.png", fig2, width=8, height=12)
#########################################################################################################
#########################################################################################################
#########################################################################################################
######################################## CHUNK 2: Figure 3 ##############################################
#########################################################################################################
## This figure swaps physiologies between calculation methods to see impact on Kp/Vss predictions
# Define location of Pearson correlation coef. on every plot (fraction of maximum x and y value f plot)
pcc_x <- 0.75
pcc_y <- 0.35
# Use Rodgers and Rowland for Poulin and Theil method
# Sum extracellular and intracellular water; sum neutral and acidic phospholipids
### Strong Base ###
# Metoprolol
met_PT <- calcKp_PT(2.15, 9.7, 0.8, BP=1.52, type=3, dat_PT)
met_RR <- calcKp_PT(2.15, 9.7, 0.8, BP=1.52, type=3, dat_PT_RR)
met <- data.frame(rep_pred = unlist(met_PT), swap_pred = unlist(met_RR)) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace_PT <- calcKp_PT(1.4, 9.7, 0.79, BP=1, type=3, dat_PT)
ace_RR <- calcKp_PT(1.4, 9.7, 0.79, BP=1, type=3, dat_PT_RR)
ace <- data.frame(rep_pred = unlist(ace_PT), swap_pred = unlist(ace_RR)) %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori_PT <- calcKp_PT(2.56, 1.76, 0.42, BP=1, type=3, dat_PT)
vori_RR <- calcKp_PT(2.56, 1.76, 0.42, BP=1, type=3, dat_PT_RR)
vori <- data.frame(rep_pred = unlist(vori_PT), swap_pred = unlist(vori_RR)) %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp_PT <- calcKp_PT(2.5, 2.4, 0.35, BP=1, type=3, dat_PT)
alp_RR <- calcKp_PT(2.5, 2.4, 0.35, BP=1, type=3, dat_PT_RR)
alp <- data.frame(rep_pred = unlist(alp_PT), swap_pred = unlist(alp_RR)) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio_PT <- calcKp_PT(2.9, 7.5, 0.13, BP=1, type=2, dat_PT)
thio_RR <- calcKp_PT(2.9, 7.5, 0.13, BP=1, type=2, dat_PT_RR)
thio <- data.frame(rep_pred = unlist(thio_PT), swap_pred = unlist(thio_RR)) %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen_PT <- calcKp_PT(0.8, 7.35, 0.78, BP=1, type=2, dat_PT)
phen_RR <- calcKp_PT(0.8, 7.35, 0.78, BP=1, type=2, dat_PT_RR)
phen <- data.frame(rep_pred = unlist(phen_PT), swap_pred = unlist(phen_RR)) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig_PT <- calcKp_PT(1.48, 0, 0.87, BP=1, type=1, dat_PT)
dig_RR <- calcKp_PT(1.48, 0, 0.87, BP=1, type=1, dat_PT_RR)
dig <- data.frame(rep_pred = unlist(dig_PT), swap_pred = unlist(dig_RR)) %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho_PT <- calcKp_PT(0.77, 0, 0.5, BP=1, type=1, dat_PT)
etho_RR <- calcKp_PT(0.77, 0, 0.5, BP=1, type=1, dat_PT_RR)
etho <- data.frame(rep_pred = unlist(etho_PT), swap_pred = unlist(etho_RR)) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo_PT <- calcKp_PT(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_PT)
oflo_RR <- calcKp_PT(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_PT_RR)
oflo <- data.frame(rep_pred = unlist(oflo_PT), swap_pred = unlist(oflo_RR)) %>%
mutate(Drug_class = "Zwitterion")
# Enoxacin
eno_PT <- calcKp_PT(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_PT)
eno_RR <- calcKp_PT(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_PT_RR)
eno <- data.frame(rep_pred = unlist(eno_PT), swap_pred = unlist(eno_RR)) %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_PT <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_PT <- round(cor(drug_all_PT$rep_pred,drug_all_PT$swap_pred,method='pearson'), digits=2)
corr_coeff_PT <- paste("italic(r) %~~%", corr_coeff_PT)
fig3a <- ggplot() +
geom_point(data=drug_all_PT, aes(x=swap_pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_PT[1:2])) +
ylim(0,max(drug_all_PT[1:2])) +
xlab("Predicted Kp (RR tissue comp.)") +
ylab("Predicted Kp (reported tissue comp.)") +
ggtitle("a    PT with RR tissue comp.") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_PT[1:2])*pcc_x, y=max(drug_all_PT[1:2])*pcc_y, label=corr_coeff_PT), parse=TRUE)
# Use R&R for Berez. (sum extracellular and intracellular water; sum neutral and acidic phospholipids)
### Strong Base ###
# Metoprolol
met_PT <- calcKp_Berez(2.15, 9.7, 0.8, BP=1.52, type=3, dat_PT)
met_RR <- calcKp_Berez(2.15, 9.7, 0.8, BP=1.52, type=3, dat_PT_RR)
met <- data.frame(rep_pred = unlist(met_PT), swap_pred = unlist(met_RR)) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace_PT <- calcKp_Berez(1.4, 9.7, 0.79, BP=1, type=3, dat_PT)
ace_RR <- calcKp_Berez(1.4, 9.7, 0.79, BP=1, type=3, dat_PT_RR)
ace <- data.frame(rep_pred = unlist(ace_PT), swap_pred = unlist(ace_RR)) %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori_PT <- calcKp_Berez(2.56, 1.76, 0.42, BP=1, type=3, dat_PT)
vori_RR <- calcKp_Berez(2.56, 1.76, 0.42, BP=1, type=3, dat_PT_RR)
vori <- data.frame(rep_pred = unlist(vori_PT), swap_pred = unlist(vori_RR)) %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp_PT <- calcKp_Berez(2.5, 2.4, 0.35, BP=1, type=3, dat_PT)
alp_RR <- calcKp_Berez(2.5, 2.4, 0.35, BP=1, type=3, dat_PT_RR)
alp <- data.frame(rep_pred = unlist(alp_PT), swap_pred = unlist(alp_RR)) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio_PT <- calcKp_Berez(2.9, 7.5, 0.13, BP=1, type=2, dat_PT)
thio_RR <- calcKp_Berez(2.9, 7.5, 0.13, BP=1, type=2, dat_PT_RR)
thio <- data.frame(rep_pred = unlist(thio_PT), swap_pred = unlist(thio_RR)) %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen_PT <- calcKp_Berez(0.8, 7.35, 0.78, BP=1, type=2, dat_PT)
phen_RR <- calcKp_Berez(0.8, 7.35, 0.78, BP=1, type=2, dat_PT_RR)
phen <- data.frame(rep_pred = unlist(phen_PT), swap_pred = unlist(phen_RR)) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig_PT <- calcKp_Berez(1.48, 0, 0.87, BP=1, type=1, dat_PT)
dig_RR <- calcKp_Berez(1.48, 0, 0.87, BP=1, type=1, dat_PT_RR)
dig <- data.frame(rep_pred = unlist(dig_PT), swap_pred = unlist(dig_RR)) %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho_PT <- calcKp_Berez(0.77, 0, 0.5, BP=1, type=1, dat_PT)
etho_RR <- calcKp_Berez(0.77, 0, 0.5, BP=1, type=1, dat_PT_RR)
etho <- data.frame(rep_pred = unlist(etho_PT), swap_pred = unlist(etho_RR)) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo_PT <- calcKp_Berez(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_PT)
oflo_RR <- calcKp_Berez(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_PT_RR)
oflo <- data.frame(rep_pred = unlist(oflo_PT), swap_pred = unlist(oflo_RR)) %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno_PT <- calcKp_Berez(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_PT)
eno_RR <- calcKp_Berez(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_PT_RR)
eno <- data.frame(rep_pred = unlist(eno_PT), swap_pred = unlist(eno_RR)) %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_Berez <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_Berez <- round(cor(drug_all_Berez$rep_pred,drug_all_Berez$swap_pred,method='pearson'), digits=2)
corr_coeff_Berez <- paste("italic(r) %~~%", corr_coeff_Berez)
fig3b <- ggplot() +
geom_point(data=drug_all_Berez, aes(x=swap_pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_Berez[1:2])) +
ylim(0,max(drug_all_Berez[1:2])) +
xlab("Predicted Kp (RR tissue comp.)") +
ylab("Predicted Kp (reported tissue comp.)") +
ggtitle("b    Berez with RR tissue comp.") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_Berez[1:2])*pcc_x, y=max(drug_all_Berez[1:2])*pcc_y, label=corr_coeff_Berez), parse=TRUE)
# Use R&R for Schmitt (sum extracellular and intracellular water)
### Strong Base ###
# Metoprolol
met_Schmitt <- calcKp_Schmitt(2.15, 9.7, 0.8, type=3, dat_Schmitt_rep)
met_RR <- calcKp_Schmitt(2.15, 9.7, 0.8, type=3, dat_Schmitt_RR)
met <- data.frame(rep_pred = unlist(met_Schmitt), swap_pred = unlist(met_RR)) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace_Schmitt <- calcKp_Schmitt(1.4, 9.7, 0.79, type=3, dat_Schmitt_rep)
ace_RR <- calcKp_Schmitt(1.4, 9.7, 0.79, type=3, dat_Schmitt_RR)
ace <- data.frame(rep_pred = unlist(ace_Schmitt), swap_pred = unlist(ace_RR)) %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori_Schmitt <- calcKp_Schmitt(2.56, 1.76, 0.42, type=3, dat_Schmitt_rep)
vori_RR <- calcKp_Schmitt(2.56, 1.76, 0.42, type=3, dat_Schmitt_RR)
vori <- data.frame(rep_pred = unlist(vori_Schmitt), swap_pred = unlist(vori_RR)) %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp_Schmitt <- calcKp_Schmitt(2.5, 2.4, 0.35, type=3, dat_Schmitt_rep)
alp_RR <- calcKp_Schmitt(2.5, 2.4, 0.35, type=3, dat_Schmitt_RR)
alp <- data.frame(rep_pred = unlist(alp_Schmitt), swap_pred = unlist(alp_RR)) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio_Schmitt <- calcKp_Schmitt(2.9, 7.5, 0.13, type=2, dat_Schmitt_rep)
thio_RR <- calcKp_Schmitt(2.9, 7.5, 0.13, type=2, dat_Schmitt_RR)
thio <- data.frame(rep_pred = unlist(thio_Schmitt), swap_pred = unlist(thio_RR)) %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen_Schmitt <- calcKp_Schmitt(0.8, 7.35, 0.78, type=2, dat_Schmitt_rep)
phen_RR <- calcKp_Schmitt(0.8, 7.35, 0.78, type=2, dat_Schmitt_RR)
phen <- data.frame(rep_pred = unlist(phen_Schmitt), swap_pred = unlist(phen_RR)) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig_Schmitt <- calcKp_Schmitt(1.48, 0, 0.87, type=1, dat_Schmitt_rep)
dig_RR <- calcKp_Schmitt(1.48, 0, 0.87, type=1, dat_Schmitt_RR)
dig <- data.frame(rep_pred = unlist(dig_Schmitt), swap_pred = unlist(dig_RR)) %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho_Schmitt <- calcKp_Schmitt(0.77, 0, 0.5, type=1, dat_Schmitt_rep)
etho_RR <- calcKp_Schmitt(0.77, 0, 0.5, type=1, dat_Schmitt_RR)
etho <- data.frame(rep_pred = unlist(etho_Schmitt), swap_pred = unlist(etho_RR)) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo_Schmitt <- calcKp_Schmitt(-0.4, c(5.97,9.28), 0.77, type=6, dat_Schmitt_rep)
oflo_RR <- calcKp_Schmitt(-0.4, c(5.97,9.28), 0.77, type=6, dat_Schmitt_RR)
oflo <- data.frame(rep_pred = unlist(oflo_Schmitt), swap_pred = unlist(oflo_RR)) %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno_Schmitt <- calcKp_Schmitt(0.1, c(6.1,8.7), 0.66, type=6, dat_Schmitt_rep)
eno_RR <- calcKp_Schmitt(0.1, c(6.1,8.7), 0.66, type=6, dat_Schmitt_RR)
eno <- data.frame(rep_pred = unlist(eno_Schmitt), swap_pred = unlist(eno_RR)) %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_Schmitt <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_Schmitt <- round(cor(drug_all_Schmitt$rep_pred,drug_all_Schmitt$swap_pred,method='pearson'), digits=2)
corr_coeff_Schmitt <- paste("italic(r) %~~%", corr_coeff_Schmitt)
fig3c <- ggplot() +
geom_point(data=drug_all_Schmitt, aes(x=swap_pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_Schmitt[1:2])) +
ylim(0,max(drug_all_Schmitt[1:2])) +
xlab("Predicted Kp (RR tissue comp.)") +
ylab("Predicted Kp (reported tissue comp.)") +
ggtitle("c    Schmitt with RR tissue comp.") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_Schmitt[1:2])*pcc_x, y=max(drug_all_Schmitt[1:2])*pcc_y, label=corr_coeff_Schmitt), parse=TRUE)
# Use R&R for PK-Sim standard (sum extracellular and intracellular water for water; replace lipids with neutral
# lipids; sum albumin and lipoprotein for proteins)
### Strong Base ###
# Metoprolol
met_pksim <- calcKp_pksim(2.15, 0.8, dat_pksim)
met_RR <- calcKp_pksim(2.15, 0.8, dat_pksim_RR)
met <- data.frame(rep_pred = unlist(met_pksim), swap_pred = unlist(met_RR)) %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace_pksim <- calcKp_pksim(1.4, 0.79, dat_pksim)
ace_RR <- calcKp_pksim(1.4, 0.79, dat_pksim_RR)
ace <- data.frame(rep_pred = unlist(ace_pksim), swap_pred = unlist(ace_RR)) %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori_pksim <- calcKp_pksim(2.56, 0.42, dat_pksim)
vori_RR <- calcKp_pksim(2.56, 0.42, dat_pksim_RR)
vori <- data.frame(rep_pred = unlist(vori_pksim), swap_pred = unlist(vori_RR)) %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp_pksim <- calcKp_pksim(2.5, 0.35, dat_pksim)
alp_RR <- calcKp_pksim(2.5, 0.35, dat_pksim_RR)
alp <- data.frame(rep_pred = unlist(alp_pksim), swap_pred = unlist(alp_RR)) %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio_pksim <- calcKp_pksim(2.9, 0.13, dat_pksim)
thio_RR <- calcKp_pksim(2.9, 0.13, dat_pksim_RR)
thio <- data.frame(rep_pred = unlist(thio_pksim), swap_pred = unlist(thio_RR)) %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen_pksim <- calcKp_pksim(0.8, 0.78, dat_pksim)
phen_RR <- calcKp_pksim(0.8, 0.78, dat_pksim_RR)
phen <- data.frame(rep_pred = unlist(phen_pksim), swap_pred = unlist(phen_RR)) %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig_pksim <- calcKp_pksim(1.48, 0.87, dat_pksim)
dig_RR <- calcKp_pksim(1.48, 0.87, dat_pksim_RR)
dig <- data.frame(rep_pred = unlist(dig_pksim), swap_pred = unlist(dig_RR)) %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho_pksim <- calcKp_pksim(0.77, 0.5, dat_pksim)
etho_RR <- calcKp_pksim(0.77, 0.5, dat_pksim_RR)
etho <- data.frame(rep_pred = unlist(etho_pksim), swap_pred = unlist(etho_RR)) %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo_pksim <- calcKp_pksim(-0.4, 0.77, dat_pksim)
oflo_RR <- calcKp_pksim(-0.4, 0.77, dat_pksim_RR)
oflo <- data.frame(rep_pred = unlist(oflo_pksim), swap_pred = unlist(oflo_RR)) %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno_pksim <- calcKp_pksim(0.1, 0.66, dat_pksim)
eno_RR <- calcKp_pksim(0.1, 0.66, dat_pksim_RR)
eno <- data.frame(rep_pred = unlist(eno_pksim), swap_pred = unlist(eno_RR)) %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_pksim <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_pksim <- round(cor(drug_all_pksim$rep_pred,drug_all_pksim$swap_pred,method='pearson'), digits=2)
corr_coeff_pksim <- paste("italic(r) %~~%", corr_coeff_pksim)
fig3d <- ggplot() +
geom_point(data=drug_all_pksim, aes(x=swap_pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_pksim[1:2])) +
ylim(0,max(drug_all_pksim[1:2])) +
xlab("Predicted Kp (RR tissue comp.)") +
ylab("Predicted Kp (reported tissue comp.") +
ggtitle("d    PK-Sim with RR tissue comp.") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_pksim[1:2])*pcc_x, y=max(drug_all_pksim[1:2])*pcc_y, label=corr_coeff_pksim), parse=TRUE)
fig3 <- grid.arrange(fig3a, fig3b, fig3c, fig3d, ncol=2, nrow=2)
ggsave(file="../deliv/figure/fig3_new.png", fig3, width=8, height=8)
ggsave(file="../deliv/figure/fig3.png", fig3, width=8, height=8)
