stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th4 +
theme(axis.text.x  = element_text(angle=45, vjust=0.5))
ggplot(data=oflo_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=oflo_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(oflo_kp$Kp)) +
#xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    Ofloxacin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th4 +
theme(axis.text.x  = element_text(angle=45, vjust=0.5))
fig4_oflo
ggplot(data=oflo_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=oflo_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(oflo_kp$Kp)) +
#xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    Ofloxacin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th4 +
theme(axis.text.x  = element_text(angle=45, vjust=0.5))
# Theme 4 used for Fig. 4
th4 <-  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),text = element_text(size = 10),
legend.justification=c(1,1), legend.position=c(1,1), legend.key=element_blank(),
legend.title = element_blank(),
plot.title = element_text(face="bold", size=15),
axis.text.x  = element_text(angle=45, vjust=0.5))
ggplot(data=vori_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=vori_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(vori_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("a    Voriconazole") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th4
pred_PT_a <- c(calcVss_PT(0.46, 9.38, 1, BP=1, type=2, dat_PT),
calcVss_PT(-1.85, 4.7, 0.76, BP=0.82, type=2, dat_PT),
calcVss_PT(-0.7, 1.82, 1, BP=1, type=2, dat_PT),
calcVss_PT(2.85, 7.45, 0.112, BP=1, type=2, dat_PT),
calcVss_PT(-0.26, 7.4, 0.044, BP=1, type=2, dat_PT),
calcVss_PT(6.97, 10.6, 0.115, BP=0.55, type=2, dat_PT))
rep_PT_a <- c(0.63,0.5,0.56,2.87, 0.32,5.53)  # reported predicted
pred_PT_b <- c(calcVss_PT(-0.07, 10.4, 0.681, BP=0.98, type=3, dat_PT),
calcVss_PT(1.71, 9.67, 0.743, BP=1, type=3, dat_PT),
calcVss_PT(3.38, 9.13, 0.27, BP=1.34, type=3, dat_PT),
calcVss_PT(4.19, 8.4, 0.0054, BP=0.71, type=3, dat_PT),
calcVss_PT(1.95, 7.76, 0.225, BP=0.9, type=3, dat_PT),
calcVss_PT(0.91, 7.12, 0.304, BP=1, type=3, dat_PT))
rep_PT_b <- c(0.53,1.25,3.26,2.68,1.22,0.52)
### Weak Bases
# Alfentanil, Cimetidine, Etomidate
pred_PT_wb <- c(calcVss_PT(2.16, 6.5, 0.074, BP=1, type=3, dat_PT),
calcVss_PT(0.4, 6.8, 0.8, BP=1, type=3, dat_PT),
calcVss_PT(3.05, 4.5, 0.235, BP=1, type=3, dat_PT))
rep_PT_wb <- c(1.38,0.56,4.55)
### Neutrals:
# Coumarin, Griseofulvin, Cyclosporin
pred_PT_n <- c(calcVss_PT(1.39, 0, 0.853, BP=1, type=1, dat_PT),
calcVss_PT(2.18, 0, 0.2, BP=1, type=1, dat_PT),
calcVss_PT(2.92, 0, 0.0602, BP=1.36, type=1, dat_PT))
rep_PT_n <- c(1.08,1.72,2.77)
### Zwitterions:
#Ciprofloxacin, Enoxacin
pred_PT_z <-c(calcVss_PT(-0.2,c(6.3,8.6),0.485,1,type=6, dat_PT),
calcVss_PT(0.28,c(6.3,8.3),0.52,1,type=6, dat_PT))
rep_PT_z <- c(0.47,0.44)
### Strong base
#Acebutolol-R (logMA)
pred_ace <- calcKp_Berez(1.4,9.7,0.79,BP=1,type=3,dat_Berez)
pksim_pred_ace <- c(0.16,1.82,2.01,0.99,1.18,1.67,1.67,1.67,1.48,0.82,1.17,1.46,1.24,1.2)
### Weak base
#Alprazolam
pred_alp <- calcKp_Berez(2.5,2.4,0.35,BP=1,type=3,dat_Berez)
pksim_pred_alp <- c(7.75,6.06,5.72,1.66,2.39,4.56,4.56,4.56,3.7,0.84,2.41,3.76,2.84,2.43)
### Acid
#Phenobarbital (logMA)
pred_phen <- calcKp_Berez(0.8,7.35,0.78,BP=0.861,type=2,dat_Berez)
pksim_pred_phen <- c(0.26,0.78,1.09,0.79,0.86,0.94,0.94,0.94,0.92,0.78,0.84,0.88,0.83,0.87)
### Neutral
pred_dig <- calcKp_Berez(1.48,0,0.87,BP=1,type=1,dat_Berez)
pksim_pred_dig <- c(1.61,2.24,2.4,1.09,1.34,1.98,1.98,1.98,1.73,0.87,1.32,1.72,1.43,1.36)
### Zwitterion
#Ofloxacin
pred_oflo <- calcKp_Berez(-0.4,c(5.97,9.28),0.77,BP=0.92,type=6,dat_Berez)
pksim_pred_oflo <- c(0.15,0.43,0.77,0.72,0.75,0.7,0.7,0.7,0.73,0.76,0.72,0.68,0.69,0.76)
# Data processing
ace <- data.frame(pred = unlist(pred_ace),rep_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
ace
ace <- data.frame(pred = unlist(pred_ace),rep_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
alp <- data.frame(pred = unlist(pred_alp),rep_pred = pksim_pred_alp) %>%
mutate(Drug_class = "Weak base")
phen <- data.frame(pred = unlist(pred_phen),rep_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
dig <- data.frame(pred = unlist(pred_dig),rep_pred = pksim_pred_dig) %>%
mutate(Drug_class = "Neutral")
oflo <- data.frame(pred = unlist(pred_oflo),rep_pred = pksim_pred_oflo) %>%
mutate(oflo, Drug_class = "Zwitterion")
drug_all <- rbind(ace,alp,phen,dig,oflo)
### Zwitterion
#Ofloxacin
pred_oflo <- calcKp_Berez(-0.4,c(5.97,9.28),0.77,BP=0.92,type=6,dat_Berez)
pksim_pred_oflo <- c(0.15,0.43,0.77,0.72,0.75,0.7,0.7,0.7,0.73,0.76,0.72,0.68,0.69,0.76)
oflo <- data.frame(pred = unlist(pred_oflo),rep_pred = pksim_pred_oflo) %>%
mutate(oflo, Drug_class = "Zwitterion")
drug_all <- rbind(ace,alp,phen,dig,oflo)
### Zwitterion
#Ofloxacin
pred_oflo <- calcKp_Berez(-0.4,c(5.97,9.28),0.77,BP=0.92,type=6,dat_Berez)
pksim_pred_oflo <- c(0.15,0.43,0.77,0.72,0.75,0.7,0.7,0.7,0.73,0.76,0.72,0.68,0.69,0.76)
oflo <- data.frame(pred = unlist(pred_oflo),rep_pred = pksim_pred_oflo) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(ace,alp,phen,dig,oflo)
# Calculate the Pearson correlation coefficient
corr_coeff_Berez <- round(cor(drug_all$pred,drug_all$rep_pred,method='pearson'), digits=2)
corr_coeff_Berez <- paste("italic(r) %~~%", corr_coeff_Berez)
fig1b <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all[1:2])) +
ylim(0,max(drug_all[1:2])) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("b    Berezhkovskiy") +
th1 +
geom_text(aes(x=4, y=2, label=corr_coeff_Berez), parse=TRUE)
fig1b
pred_PT_a <- c(calcVss_PT(0.46, 9.38, 1, BP=1, type=2, dat_PT),
calcVss_PT(-1.85, 4.7, 0.76, BP=0.82, type=2, dat_PT),
calcVss_PT(-0.7, 1.82, 1, BP=1, type=2, dat_PT),
calcVss_PT(2.85, 7.45, 0.112, BP=1, type=2, dat_PT),
calcVss_PT(-0.26, 7.4, 0.044, BP=1, type=2, dat_PT),
calcVss_PT(6.97, 10.6, 0.115, BP=0.55, type=2, dat_PT))
rep_PT_a <- c(0.63,0.5,0.56,2.87, 0.32,5.53)  # reported predicted
### Strong Bases:
# Caffeine, Acebutolol, Chlorpheniramine, Carvedilol, Mepivacaine, Trimethoprim
pred_PT_b <- c(calcVss_PT(-0.07, 10.4, 0.681, BP=0.98, type=3, dat_PT),
calcVss_PT(1.71, 9.67, 0.743, BP=1, type=3, dat_PT),
calcVss_PT(3.38, 9.13, 0.27, BP=1.34, type=3, dat_PT),
calcVss_PT(4.19, 8.4, 0.0054, BP=0.71, type=3, dat_PT),
calcVss_PT(1.95, 7.76, 0.225, BP=0.9, type=3, dat_PT),
calcVss_PT(0.91, 7.12, 0.304, BP=1, type=3, dat_PT))
rep_PT_b <- c(0.53,1.25,3.26,2.68,1.22,0.52)
### Weak Bases
# Alfentanil, Cimetidine, Etomidate
pred_PT_wb <- c(calcVss_PT(2.16, 6.5, 0.074, BP=1, type=3, dat_PT),
calcVss_PT(0.4, 6.8, 0.8, BP=1, type=3, dat_PT),
calcVss_PT(3.05, 4.5, 0.235, BP=1, type=3, dat_PT))
rep_PT_wb <- c(1.38,0.56,4.55)
### Neutrals:
# Coumarin, Griseofulvin, Cyclosporin
pred_PT_n <- c(calcVss_PT(1.39, 0, 0.853, BP=1, type=1, dat_PT),
calcVss_PT(2.18, 0, 0.2, BP=1, type=1, dat_PT),
calcVss_PT(2.92, 0, 0.0602, BP=1.36, type=1, dat_PT))
rep_PT_n <- c(1.08,1.72,2.77)
### Zwitterions:
#Ciprofloxacin, Enoxacin
pred_PT_z <-c(calcVss_PT(-0.2,c(6.3,8.6),0.485,1,type=6, dat_PT),
calcVss_PT(0.28,c(6.3,8.3),0.52,1,type=6, dat_PT))
rep_PT_z <- c(0.47,0.44)
# Data processing
sbase <- data.frame(pred = unlist(pred_PT_b),rep_pred = rep_PT_b) %>%
mutate(Drug_class = "Strong base")
wbase <- data.frame(pred = unlist(pred_PT_wb),rep_pred = rep_PT_wb) %>%
mutate(Drug_class = "Weak base")
acid <- data.frame(pred = unlist(pred_PT_a),rep_pred = rep_PT_a) %>%
mutate(Drug_class = "Acid")
neut <- data.frame(pred = unlist(pred_PT_n),rep_pred = rep_PT_n) %>%
mutate(Drug_class = "Neutral")
zwit <- data.frame(pred = unlist(pred_PT_z),rep_pred = rep_PT_z) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(sbase,wbase,acid,neut,zwit)
# Calculate the Pearson correlation coefficient
corr_coeff_PT <- round(cor(drug_all$pred,drug_all$rep_pred,method='pearson'), digits=2)
corr_coeff_PT <- paste("italic(r) %~~%", corr_coeff_PT)
fig1a <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all[1:2])) +
ylim(0,max(drug_all[1:2])) +
xlab("Predicted Vss") +
ylab("Reported Vss") +
ggtitle("a    Poulin and Theil") +
th1 +
geom_text(aes(x=3, y=2, label=corr_coeff_PT), parse=TRUE)
fig1a
## Berezhlovskiy figure ##
### Strong base
#Acebutolol-R (logMA)
pred_ace <- calcKp_Berez(1.4,9.7,0.79,BP=1,type=3,dat_Berez)
pksim_pred_ace <- c(0.16,1.82,2.01,0.99,1.18,1.67,1.67,1.67,1.48,0.82,1.17,1.46,1.24,1.2)
### Weak base
#Alprazolam
pred_alp <- calcKp_Berez(2.5,2.4,0.35,BP=1,type=3,dat_Berez)
pksim_pred_alp <- c(7.75,6.06,5.72,1.66,2.39,4.56,4.56,4.56,3.7,0.84,2.41,3.76,2.84,2.43)
### Acid
#Phenobarbital (logMA)
pred_phen <- calcKp_Berez(0.8,7.35,0.78,BP=0.861,type=2,dat_Berez)
pksim_pred_phen <- c(0.26,0.78,1.09,0.79,0.86,0.94,0.94,0.94,0.92,0.78,0.84,0.88,0.83,0.87)
### Neutral
pred_dig <- calcKp_Berez(1.48,0,0.87,BP=1,type=1,dat_Berez)
pksim_pred_dig <- c(1.61,2.24,2.4,1.09,1.34,1.98,1.98,1.98,1.73,0.87,1.32,1.72,1.43,1.36)
### Zwitterion
#Ofloxacin
pred_oflo <- calcKp_Berez(-0.4,c(5.97,9.28),0.77,BP=0.92,type=6,dat_Berez)
pksim_pred_oflo <- c(0.15,0.43,0.77,0.72,0.75,0.7,0.7,0.7,0.73,0.76,0.72,0.68,0.69,0.76)
# Data processing
ace <- data.frame(pred = unlist(pred_ace),rep_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
alp <- data.frame(pred = unlist(pred_alp),rep_pred = pksim_pred_alp) %>%
mutate(Drug_class = "Weak base")
phen <- data.frame(pred = unlist(pred_phen),rep_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
dig <- data.frame(pred = unlist(pred_dig),rep_pred = pksim_pred_dig) %>%
mutate(Drug_class = "Neutral")
oflo <- data.frame(pred = unlist(pred_oflo),rep_pred = pksim_pred_oflo) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(ace,alp,phen,dig,oflo)
# Calculate the Pearson correlation coefficient
corr_coeff_Berez <- round(cor(drug_all$pred,drug_all$rep_pred,method='pearson'), digits=2)
corr_coeff_Berez <- paste("italic(r) %~~%", corr_coeff_Berez)
fig1b <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=rep_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all[1:2])) +
ylim(0,max(drug_all[1:2])) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("b    Berezhkovskiy") +
th1 +
geom_text(aes(x=4, y=2, label=corr_coeff_Berez), parse=TRUE)
fig1b
## Rodgers and Rowland figure ##
# load data
#dat_RR <- read.csv("../data/tissue_comp_R&R.csv")
# Acids:
# Cefazolin
pred_RR_a_all <- calcKpu_RR(0.3, 2.3, 0.16, BP=0.55, type=2, dat_RR)
pred_RR_a <- c(pred_RR_a_all[1], pred_RR_a_all[3:8], pred_RR_a_all[10])
rep_RR_a <- c(0.74,1.28,1.23,1.1,0.79,1.52,0.69,1.92)
# Phenobarbital
pred_RR_a_all2 <- calcKpu_RR(1.6, 7.4, 0.64, BP=0.861, type=2, dat_RR)
pred_RR_a2 <- c(pred_RR_a_all2[3:8], pred_RR_a_all2[10], pred_RR_a_all2[13])
rep_RR_a2 <- c(1.43,0.88,0.97,0.92,1.07,0.79,1.84,1.23)
#Phenytoin
#pred_RR_a_all3 <- calcKpu_RR(2.5,8.3,0.19,BP=0.19,type=2)
#pred_RR_a3 <- c(pred_RR_a_all3[2:8],pred_RR_a_all3[10],pred_RR_a_all3[13])
#exp_RR_a3  <- c(4.7,12.9,6.2,8.27,11.9,4.91,5.68,8.79,9.3)
#rep_RR_a3 <- c(12.0,12.9,5.81,6.55,6.74,8.39,4.33,19.0,21.2)
# Bases:
#Alfentanil (weak)
pred_RR_b_all <- calcKpu_RR(2.2, 6.5, 0.11, BP=1, type=3, dat_RR)
pred_RR_b <- c(pred_RR_b_all[2:11], pred_RR_b_all[13])
rep_RR_b <- c(6.3,7.33,3.97,4.24,4.05,5.48,2.88,6.71,10.7,2.7,9.2)
#Strong bases:
# Bisoprolol-R
pred_RR_sb_all <- calcKpu_RR(1.87, 9.4, 0.85, BP=1.36, type=3, dat_RR)
pred_RR_sb <- c(pred_RR_sb_all[1:8], pred_RR_sb_all[10], pred_RR_sb_all[12:13])
rep_RR_sb <- c(3.61,3.36,11,10.4,21.4,19.6,17.2,7.73,6.37,10.8,1.79)
#Acebutolol-R
pred_RR_sb_all2 <- calcKpu_RR(1.87, 9.7, 0.79, BP=1.09, type=3, dat_RR)
pred_RR_sb2 <- c(pred_RR_sb_all2[1:8], pred_RR_sb_all2[10], pred_RR_sb_all2[12:13])
rep_RR_sb2 <- c(2.34,2.57,6.45,6.1,11.8,11.0,9.67,4.84,3.85,6.45,0.82)
#Neutral:
# Ethoxybenzamide
pred_RR_n_all <- calcKpu_RR(0.77, 0, 0.5, BP=1, type=1, dat_RR)
pred_RR_n <- c(pred_RR_n_all[2:5], pred_RR_n_all[7:8], pred_RR_n_all[10:11], pred_RR_n_all[13])
rep_RR_n <- c(1.03,1.1,0.79,0.91,0.86,0.85,1.11,0.78,0.48)
#Zwitterions:
#Enoxacin
pred_eno <- calcKpu_RR(log10(1.26), c(6.1,8.7), 0.66, BP=0.94, type=6, dat_RR)
pred_eno <- c(pred_eno[1], pred_eno[4:8], pred_eno[10:11])
rep_eno <- c(1.74,4.62,9.88,9.04,7.61,3.74,3.16,6.33)
# #Nalidixic acid
# pred_nal <- calcKpu_RR(log10(12.6),c(5.1,3.3),0.29,type=6)
# pred_nal <- c(pred_nal[1:8],pred_nal[10:11],pred_nal[13])
# rep_nal <- c(0.47,0.52,0.86,0.8,0.75,0.57,0.95,0.52,1.17,0.59,0.27)
#
# #Ceftazidime
# pred_ceft <- calcKpu_RR(log10(0.316),c(2.5,1.9,3.8),0.1,type=9)
# pred_ceft <- c(pred_ceft[3:8],pred_ceft[10],pred_ceft[13])
# rep_ceft <- c(0.48,0.44,0.45,0.36,0.45,0.37,0.52,0.14)
# Data processing
alf <- data.frame(pred = unlist(pred_RR_b),rep = rep_RR_b) %>%
mutate(Drug_class = "Weak base")
ace <- data.frame(pred = unlist(pred_RR_sb2),rep = rep_RR_sb2) %>%
mutate(Drug_class = "Strong base")
bis <- data.frame(pred = unlist(pred_RR_sb),rep = rep_RR_sb) %>%
mutate(Drug_class = "Strong base")
phen <- data.frame(pred = unlist(pred_RR_a2),rep = rep_RR_a2) %>%
mutate(Drug_class = "Acid")
cef <- data.frame(pred = unlist(pred_RR_a),rep = rep_RR_a) %>%
mutate(Drug_class = "Acid")
etho <- data.frame(pred = unlist(pred_RR_n),rep = rep_RR_n) %>%
mutate(Drug_class = "Neutral")
eno <- data.frame(pred = unlist(pred_eno),rep = rep_eno) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(alf,ace,bis,phen,cef,etho,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_RR <- round(cor(drug_all$pred,drug_all$rep,method='pearson'), digits=2)
corr_coeff_RR <- paste("italic(r) %~~%", corr_coeff_RR)
fig1c <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=rep, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all[1:2])) +
ylim(0,max(drug_all[1:2])) +
xlab("Predicted Kpu") +
ylab("Reported Kpu") +
ggtitle("c    Rodgers and Rowland") +
th1 +
geom_text(aes(x=12, y=5, label=corr_coeff_RR), parse=TRUE)
fig1c
## Schmitt figure ##
# load data
# dat <- read.csv("../data/tissue_comp_Schmitt.csv")  # this doesn't work but pksim tissue composition does; ask Kiersten
#dat_Schmitt <- read.csv("../data/PKSim_tissue_comp_Schmitt.csv")
#Using logMA below, could also use logP
### Strong base
#Quinidine (logMA=2.3)
pred_quin <- calcKp_Schmitt(2.3, 8.6, 0.33, type=3, dat_Schmitt)
pksim_pred_quin <- c(1.6,22.23,2.85,16.4,12.89,6.22,6.22,6.22,14.85,7.17,1.99,3.26,5.32,5.17)
#Acebutolol-R
pred_ace <- calcKp_Schmitt(1.4, 9.7, 0.79, type=3, dat_Schmitt)
pksim_pred_ace <- c(0.69,7.38,0.38,5.52,4.51,2.45,2.45,2.45,5.08,2.69,1.15,1.48,1.94,2.13)
#pred_ace_p <- calcKp_Schmitt(1.87,9.7,0.79,type=3, dat_Schmitt)
#pksim_pred_ace_p <- c(1.57,20.55,1.06,15.17,12.13,5.99,5.99,5.99,13.88,6.78,2.17,3.23,4.91,5.06) #using logP=1.87
### Weak base
#Alprazolam
pred_alp <- calcKp_Schmitt(2.5, 2.4, 0.35, type=3, dat_Schmitt)
pksim_pred_alp <- c(2.83,12.65,102.27,12.9,7.42,8.4,8.4,8.4,9.53,4.96,1.85,6.21,16.68,3.03)
### Acid
#Phenobarbital (logMA)
pred_phen <- calcKp_Schmitt(0.8, 7.35, 0.78, type=2, dat_Schmitt)
pksim_pred_phen <- c(0.32,1.08,2.95,1.02,0.87,0.85,0.85,0.85,0.9,0.78,0.68,0.73,0.96,0.72)
### Neutral
pred_dig <- calcKp_Schmitt(1.48, 0, 0.87, type=1, dat_Schmitt)
pksim_pred_dig <- c(0.9,3.64,24.31,3.64,2.36,2.63,2.63,2.63,2.82,1.77,1.06,2.05,4.38,1.34)
### Zwitterion
# Ofloxacin
# logP = -0.4, pKa = c(5.97,9.28) , fup = 0.77, BP = 0.92, type = 6 (monoprotic acid, monoprotic base)
pred_oflo <- calcKp_Schmitt(-0.4, c(5.97,9.28), 0.77, type=6, dat_Schmitt)
pksim_pred_oflo <- c(0.23,0.66,0.29,0.6,0.61,0.64,0.64,0.64,0.58,0.6,0.61,0.58,0.46,0.62)
# Data processing
quin <- data.frame(pred = unlist(pred_quin),pksim_pred = pksim_pred_quin) %>%
mutate(Drug_class = "Strong base")
ace <- data.frame(pred = unlist(pred_ace),pksim_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
alp <- data.frame(pred = unlist(pred_alp),pksim_pred = pksim_pred_alp) %>%
mutate(Drug_class = "Weak base")
phen <- data.frame(pred = unlist(pred_phen),pksim_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
dig <- data.frame(pred = unlist(pred_dig),pksim_pred = pksim_pred_dig) %>%
mutate(Drug_class = "Neutral")
oflo <- data.frame(pred = unlist(pred_oflo),pksim_pred = pksim_pred_oflo) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(quin,ace,alp,phen,dig,oflo)
# Calculate the Pearson correlation coefficient
corr_coeff_Schmitt <- round(cor(drug_all$pred,drug_all$pksim_pred,method='pearson'), digits=2)
corr_coeff_Schmitt <- paste("italic(r) %~~%", corr_coeff_Schmitt)
fig1d <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=pksim_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all$pred)) +
ylim(0,max(drug_all$pksim_pred)) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("d    Schmitt") +
th1 +
geom_text(aes(x=50, y=25, label=corr_coeff_Schmitt), parse=TRUE)
fig1d
## PK-Sim standard figure ##
### Strong Base
# Acebutolol-R
pred_ace <- calcKp_pksim(1.87, 0.79, dat_pksim)
pksim_pred_ace <- c(16.44,7.2,47.04,6.67,3.9,4.45,4.45,4.45,4.89,1.48,1.65,5.43,6.75,1.83)
### Weak Base
# Triazolam
pred_tri <- calcKp_pksim(2.4, 0.28, dat_pksim)
pksim_pred_tri <- c(19.41,8.09,56.39,7.51,4.15,4.79,4.79,4.79,5.36,1.22,1.42,6.03,7.66,1.65)
### Acids
# Phenobarbital
pred_phen <- calcKp_pksim(1.6, 0.64, dat_pksim)
pksim_pred_phen <- c(7.3,3.37,20.51,3.13,1.93,2.18,2.18,2.18,2.36,0.89,0.97,2.58,3.13,1.03)
###Neutral
# Ethoxybenzamide
pred_etho <- calcKp_pksim(0.77, 0.5, dat_pksim)
pksim_pred_etho <- c(1.06,0.74,2.44,0.68,0.57,0.6,0.6,0.6,0.6,0.46,0.47,0.61,0.64,0.46)
###Zwitterion
#Enoxacin
pred_eno <- calcKp_pksim(0.100, 0.66, dat_pksim)
pksim_pred_eno <- c(0.56,0.63,0.77,0.59,0.58,0.59,0.59,0.59,0.57,0.56,0.57,0.55,0.52,0.55)
# Data processing
ace <- data.frame(pred = unlist(pred_ace),pksim_pred = pksim_pred_ace) %>%
mutate(Drug_class = "Strong base")
tri <- data.frame(pred = unlist(pred_tri),pksim_pred = pksim_pred_tri) %>%
mutate(Drug_class = "Weak base")
phen <- data.frame(pred = unlist(pred_phen),pksim_pred = pksim_pred_phen) %>%
mutate(Drug_class = "Acid")
etho <- data.frame(pred = unlist(pred_etho),pksim_pred = pksim_pred_etho) %>%
mutate(Drug_class = "Neutral")
eno <- data.frame(pred = unlist(pred_eno),pksim_pred = pksim_pred_eno) %>%
mutate(Drug_class = "Zwitterion")
drug_all <- rbind(ace,alp,phen,dig,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_pksim <- round(cor(drug_all$pred,drug_all$pksim_pred,method='pearson'), digits=2)
corr_coeff_pksim <- paste("italic(r) %~~%", corr_coeff_pksim)
fig1e <- ggplot() +
geom_point(data=drug_all, aes(x=pred, y=pksim_pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all$pred)) +
ylim(0,max(drug_all$pksim_pred)) +
xlab("Predicted Kp") +
ylab("Reported Kp (PK-Sim)") +
ggtitle("e    PK-Sim Standard") +
th1 +
geom_text(aes(x=50, y=25, label=corr_coeff_pksim), parse=TRUE)
fig1e
fig1 <- grid.arrange(fig1a, fig1b, fig1c, fig1d, fig1e, ncol=2, nrow=3)
fig1
#########################################################################################################
######################################## CHUNK 5: Figure 5 ##############################################
#########################################################################################################
## This figure shows the impact of calculation methods on the model predictions from each drug class
## representative
source("getPartitionCoeff.R")
######################################### Voriconazole - weak base ###################################
# Compile model
mod <- mread("../model/voriPBPK_Adult")
# Load data
df <- read.csv("../data/obs_voriconazole.csv")
df_new <- mutate(df, Method = "Observed")
# Calculate Kps
type <- 3  #base
logP <- 2.56
pKa <- 1.76  #base
fup <- 0.42
BP <- 1
Kps1 <- pcoeffs(logP=logP, pKa=pKa, fup=fup, BP=BP, type=type, pred="P&T", dat_uni)
Kps2 <- pcoeffs(logP=logP, pKa=pKa, fup=fup, BP=BP, type=type, pred="Berez", dat_uni)
Kps3 <- pcoeffs(logP=logP, pKa=pKa, fup=fup, BP=BP, type=type, pred="R&R", dat_uni)
Kps4 <- pcoeffs(logP=logP, pKa=pKa, fup=fup, BP=BP, type=type, pred="Schmitt", dat_uni)
Kps5 <- pcoeffs(logP=logP, pKa=pKa, fup=fup, BP=BP, type=type, pred="pksim", dat_uni)
## new parameter list
pars1 <- c(Kps1, list(fup=fup, BP=BP))
pars2 <- c(Kps2, list(fup=fup, BP=BP))
pars3 <- c(Kps3, list(fup=fup, BP=BP))
pars4 <- c(Kps4, list(fup=fup, BP=BP))
pars5 <- c(Kps5, list(fup=fup, BP=BP))
bw <- 73
e <- ev(amt = 4*bw, cmt = "VEN", ii = 12, addl = 13, rate = 4*bw, ss = 1)
outFun <- function(pars){
out <- as.data.frame(out <- mod %>%
param(pars) %>%
ev(e) %>%
mrgsim(end=10, delta=0.01) %>%
as.data.frame() %>%
dplyr::filter(dplyr::row_number() > 1))
return(out)
}
out1 <- outFun(pars1) %>%
mutate(Method = "P&T")
out2 <- outFun(pars2) %>%
mutate(Method = "Berezhkovskiy")
out3 <- outFun(pars3) %>%
mutate(Method = "R&R")
out4 <- outFun(pars4) %>%
mutate(Method = "Schmitt")
out5 <- outFun(pars5) %>%
mutate(Method = "PK-Sim standard")
# Bind all outputs into one matrix
out_all <- rbind(out1,out2,out3,out4,out5)
num_pts <- 25
out1_reduced <- out1[seq(1, nrow(out1), num_pts), ]
out2_reduced <- out2[seq(1, nrow(out2), num_pts), ]
out3_reduced <- out3[seq(1, nrow(out3), num_pts), ]
out4_reduced <- out4[seq(1, nrow(out4), num_pts), ]
out5_reduced <- out5[seq(1, nrow(out5), num_pts), ]
out_reduced <- rbind(out1_reduced,out2_reduced,out3_reduced,out4_reduced,out5_reduced)
df_new <- mutate(df, Method = "Observed")
plot_vori <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df_new, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df_new, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("Voriconazole") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th5
plot_vori
