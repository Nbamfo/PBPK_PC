geom_point(data=met_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(met_kp$Kp)) +
xlab("") +
ylab("Predicted Kp") +
ggtitle("a    Metoprolol") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_met
# Caffeine
caf_kp <- kp_pred_comp(-0.07, 10.4, 0.681, BP=0.98, type=3, dat_uni)
fig5_caf <- ggplot(data=caf_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=caf_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(caf_kp$Kp)) +
xlab("") +
ylab("Predicted Kp") +
ggtitle("a    Caffeine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_caf
### Weak Bases ###
# Voriconazole
vori_kp <- kp_pred_comp(2.56, 1.76, 0.42, BP=1, type=3, dat_uni)
fig5_vori <- ggplot(data=vori_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=vori_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(vori_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("b    Voriconazole") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_vori
# Alfentanil
alf_kp <- kp_pred_comp(2.2, 6.5, 0.11, BP=0.63, type=3, dat_uni)
fig5_alf <- ggplot(data=alf_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=alf_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(alf_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("b    Alfentanil") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_alf
# Midazolam
mid_kp <- kp_pred_comp(3.1, 6, 0.059, BP=1, type=3, dat_uni)
fig5_mid <- ggplot(data=mid_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=mid_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(mid_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("c    Midazolam") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_mid
# Nevirapine
nev_kp <- kp_pred_comp(1.93, 2.8, 0.4, BP=1.04, type=3, dat_uni)
fig5_nev <- ggplot(data=nev_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=nev_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(nev_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("d    Nevirapine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_nev
### Acid ###
# Thiopental
thio_kp <- kp_pred_comp(2.9, 7.5, 0.13, BP=1, type=2, dat_uni)
fig5_thio <- ggplot(data=thio_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=thio_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(thio_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    S-Thiopental") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_thio
# Nifedipine
nif_kp <- kp_pred_comp(2.2, 3.93, 0.04, BP=0.73, type=2, dat_uni)
fig5_nif <- ggplot(data=nif_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=nif_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(nif_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("c    Nifedipine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_nif
### Neutral ###
# Digoxin
dig_kp <- kp_pred_comp(1.48, 0, 0.87, BP=1, type=1, dat_uni)
fig5_dig <- ggplot(data=dig_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=dig_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(dig_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("d    Digoxin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_dig
# Artemether
art_kp <- kp_pred_comp(3.28, 0, 0.046, BP=0.8, type=1, dat_uni)
fig5_art <- ggplot(data=art_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=art_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(art_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("f    Artemether") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_art
### Zwitterion ###
# Ofloxacin
oflo_kp <- kp_pred_comp(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni)
fig5_oflo <- ggplot(data=oflo_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=oflo_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(oflo_kp$Kp)+1.4) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    Ofloxacin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_oflo
fig5 <- grid.arrange(fig5_met, fig5_vori, fig5_nif, fig5_dig, fig5_oflo, ncol=2, nrow=3)
figS1 <- grid.arrange(fig5_caf, fig5_alf, fig5_mid, fig5_nev, fig5_thio, fig5_art, ncol=2, nrow=3)
figS1 <- grid.arrange(fig5_caf, fig5_alf, fig5_mid, fig5_nev, fig5_thio, fig5_art, ncol=2, nrow=3)
ggsave(file="../deliv/figure/figS1.png", figS1, width=8, height=12)
kp_pred_comp <- function(logP, pKa, fup, BP, type, dat_uni){
drug_PT <- as.numeric(calcKp_PT(logP, pKa, fup, BP, type, dat_uni))
drug_Berez <- as.numeric(calcKp_Berez(logP, pKa, fup, BP, type, dat_uni))
drug_RR <- as.numeric(calcKp_RR(logP, pKa, fup, BP, type, dat_uni))
drug_Schmitt <- as.numeric(calcKp_Schmitt(logP, pKa, fup, type, dat_uni))
drug_pksim <- as.numeric(calcKp_pksim(logP, fup, dat_uni))
drug_kp_all <- cbind(drug_PT, drug_Berez, drug_RR, drug_Schmitt, drug_pksim)
drug_var <- apply(drug_kp_all, 1, var)
drug_kp_all <- round(cbind(drug_kp_all, drug_var), digits=3)
rownames(drug_kp_all) <- c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")
drug_PT_new <- drug_PT %>%
as.data.frame() %>%
mutate(Method="Poulin and Theil") %>%
mutate(Tissue=c(1:11))
drug_Berez_new <- drug_Berez %>%
as.data.frame() %>%
mutate(Method="Berezhkovskiy") %>%
mutate(Tissue=c(1:11))
drug_RR_new <- drug_RR %>%
as.data.frame() %>%
mutate(Method="Rodgers and Rowland") %>%
mutate(Tissue=c(1:11))
drug_Schmitt_new <- drug_Schmitt %>%
as.data.frame() %>%
mutate(Method="Schmitt") %>%
mutate(Tissue=c(1:11))
drug_pksim_new <- drug_pksim %>%
as.data.frame() %>%
mutate(Method="PK-Sim Standard") %>%
mutate(Tissue=c(1:11))
drug_kp <- rbind(drug_PT_new,drug_Berez_new,drug_RR_new,drug_Schmitt_new,drug_pksim_new)
names(drug_kp)[1] <- "Kp"
return(drug_kp)
}
### Strong Bases ###
# Metoprolol
met_kp <- kp_pred_comp(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni)
fig5_met <- ggplot(data=met_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=met_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(met_kp$Kp)) +
xlab("") +
ylab("Predicted Kp") +
ggtitle("a    Metoprolol") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_met
# Caffeine
caf_kp <- kp_pred_comp(-0.07, 10.4, 0.681, BP=0.98, type=3, dat_uni)
fig5_caf <- ggplot(data=caf_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=caf_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(caf_kp$Kp)) +
xlab("") +
ylab("Predicted Kp") +
ggtitle("a    Caffeine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_caf
### Weak Bases ###
# Voriconazole
vori_kp <- kp_pred_comp(2.56, 1.76, 0.42, BP=1, type=3, dat_uni)
fig5_vori <- ggplot(data=vori_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=vori_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(vori_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("b    Voriconazole") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_vori
# Alfentanil
alf_kp <- kp_pred_comp(2.2, 6.5, 0.11, BP=0.63, type=3, dat_uni)
fig5_alf <- ggplot(data=alf_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=alf_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(alf_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("b    Alfentanil") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_alf
# Midazolam
mid_kp <- kp_pred_comp(3.1, 6, 0.059, BP=1, type=3, dat_uni)
fig5_mid <- ggplot(data=mid_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=mid_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(mid_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("c    Midazolam") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_mid
# Nevirapine
nev_kp <- kp_pred_comp(1.93, 2.8, 0.4, BP=1.04, type=3, dat_uni)
fig5_nev <- ggplot(data=nev_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=nev_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(nev_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("d    Nevirapine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_nev
### Acid ###
# Thiopental
thio_kp <- kp_pred_comp(2.9, 7.5, 0.13, BP=1, type=2, dat_uni)
fig5_thio <- ggplot(data=thio_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=thio_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(thio_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    Thiopental") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_thio
# Nifedipine
nif_kp <- kp_pred_comp(2.2, 3.93, 0.04, BP=0.73, type=2, dat_uni)
fig5_nif <- ggplot(data=nif_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=nif_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(nif_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("c    Nifedipine") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_nif
### Neutral ###
# Digoxin
dig_kp <- kp_pred_comp(1.48, 0, 0.87, BP=1, type=1, dat_uni)
fig5_dig <- ggplot(data=dig_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=dig_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(dig_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("d    Digoxin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_dig
# Artemether
art_kp <- kp_pred_comp(3.28, 0, 0.046, BP=0.8, type=1, dat_uni)
fig5_art <- ggplot(data=art_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=art_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(art_kp$Kp)) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("f    Artemether") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_art
### Zwitterion ###
# Ofloxacin
oflo_kp <- kp_pred_comp(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni)
fig5_oflo <- ggplot(data=oflo_kp, aes(x=Tissue, y=Kp)) +
geom_point(data=oflo_kp, aes(x=Tissue, y=Kp, shape=Method),size=2.5, stroke=0.5) +
scale_x_continuous(breaks=c(1,2,3,4,5,6,7,8,9,10,11),labels = c("Adipose","Bone","Brain","Heart","Kidney","Gut","Liver","Lung","Muscle","Skin","Spleen")) +
ylim(0,max(oflo_kp$Kp)+1.4) +
xlab("Tissue") +
ylab("Predicted Kp") +
ggtitle("e    Ofloxacin") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
stat_summary(fun.y = median, fun.ymin = median, fun.ymax = median,
geom = "crossbar", width = 0.5, fatten=0.1) +
th5
fig5_oflo
fig5 <- grid.arrange(fig5_met, fig5_vori, fig5_nif, fig5_dig, fig5_oflo, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig5.png", fig5, width=8, height=12)
figS1 <- grid.arrange(fig5_caf, fig5_alf, fig5_mid, fig5_nev, fig5_thio, fig5_art, ncol=2, nrow=3)
ggsave(file="../deliv/figure/figS1.png", figS1, width=8, height=12)
# Caffeine
source("PBPK_sim_caffeine.R")
plot_caf <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2) +
geom_errorbar(data=df, aes(x=time, ymin=pmax(conc-(sd_max-conc),0), ymax=sd_max), width=.1) +
xlim(-0.1,24.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("a  Caffeine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Alfentanil
source("PBPK_sim_alfentanil.R")
plot_alf <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method), size=2, stroke=0.6) +
geom_point(data=df_mean, aes(x=time, y=mean), size=2) +
geom_errorbar(data=df_mean, aes(x=time, ymin=pmax(mean-SD,0), ymax=mean+SD), width=.1) +
xlim(-0.1,12.1) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("b  Alfentanil") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Midazolam
source("PBPK_sim_midazolam.R")
plot_mid <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.5) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin = conc-(max_sd-conc), ymax = max_sd), width=.1) +
xlim(0,6.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("c  Midazolam") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Nevirapine
source( "PBPK_sim_nevirapine.R")
plot_nev <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
xlim(0,100) +
#ylim(0,350) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("d  Nevirapine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Acids ###
# Thiopental
source("PBPK_sim_thiopental.R")
plotS <-  ggplot() +
geom_line(data=out_all_S,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_S,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("e  S-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
plotR <-  ggplot() +
geom_line(data=out_all_R,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_R,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df_R, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("R-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Artemether
source("PBPK_sim_artemether.R")
plot_art <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = pmax(conc-(max_sd-conc),0), ymax = max_sd), width=.1) +
xlim(0,16.2) +
ylim(0,0.35) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("f  Artemether") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
figS2_new <- grid.arrange(plot_caf, plot_alf, plot_mid, plot_nev, plotS, plotR, plot_art, ncol=2, nrow=4)
ggsave(file="../deliv/figure/figS2_new.png", figS2_new, width=8, height=12)
ggsave(file="../deliv/figure/figS2_new.png", figS2_new, width=8, height=16)
### Acids ###
# Thiopental
source("PBPK_sim_thiopental.R")
plotS <-  ggplot() +
geom_line(data=out_all_S,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_S,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("e  S-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
plotR <-  ggplot() +
geom_line(data=out_all_R,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_R,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df_R, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("f  R-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Artemether
source("PBPK_sim_artemether.R")
plot_art <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = pmax(conc-(max_sd-conc),0), ymax = max_sd), width=.1) +
xlim(0,16.2) +
ylim(0,0.35) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("g  Artemether") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
figS2_new <- grid.arrange(plot_caf, plot_alf, plot_mid, plot_nev, plotS, plotR, plot_art, ncol=2, nrow=4)
ggsave(file="../deliv/figure/figS2_new.png", figS2_new, width=8, height=16)
