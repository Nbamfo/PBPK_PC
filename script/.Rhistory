th5
fig5 <- grid.arrange(fig5_met, fig5_vori, fig5_nif, fig5_dig, fig5_oflo, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig5_new.png", fig5, width=8, height=12)
figS1 <- grid.arrange(fig5_caf, fig5_alf, fig5_mid, fig5_nev, fig5_thio, fig5_art, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/figS1_new.png", figS1, width=8, height=12)
#########################################################################################################
#########################################################################################################
#########################################################################################################
######################################## CHUNK 5: Figure 6 ##############################################
#########################################################################################################
## This figure shows the impact of calculation methods on the model predictions from each drug class
## representative
### Strong bases ###
# Metoprolol
source("PBPK_sim_metoprolol.R")
plot_met <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=mean), size=2) +
geom_errorbar(data=df, aes(x=time, ymin=mean-sd, ymax=mean+sd), width=.1) +
xlim(0,13) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("a  Metoprolol") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Caffeine
source("PBPK_sim_caffeine.R")
plot_caf <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2) +
geom_errorbar(data=df, aes(x=time, ymin=pmax(conc-(sd_max-conc),0), ymax=sd_max), width=.1) +
xlim(-0.1,24.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("a  Caffeine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Weak bases ###
# Voriconazole
source("PBPK_sim_voriconazole.R")
plot_vori <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("b  Voriconazole") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Alfentanil
source("PBPK_sim_alfentanil.R")
plot_alf <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method), size=2, stroke=0.6) +
geom_point(data=df_mean, aes(x=time, y=mean), size=2) +
geom_errorbar(data=df_mean, aes(x=time, ymin=pmax(mean-SD,0), ymax=mean+SD), width=.1) +
xlim(-0.1,12.1) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("b  Alfentanil") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Midazolam
source("PBPK_sim_midazolam.R")
plot_mid <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.5) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin = conc-(max_sd-conc), ymax = max_sd), width=.1) +
xlim(0,6.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("c  Midazolam") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Nevirapine
source( "PBPK_sim_nevirapine.R")
plot_nev <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
xlim(0,100) +
#ylim(0,350) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("d  Nevirapine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Acids ###
# Thiopental
source("PBPK_sim_thiopental.R")
plotS <-  ggplot() +
geom_line(data=out_all_S,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_S,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("e  S-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
plotR <-  ggplot() +
geom_line(data=out_all_R,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced_R,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df_R, aes(x=time, y=conc), size=2.5) +
xlim(0,15) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("f  R-Thiopental") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Plot both R-thiopental and S-thiopental together
plot_thio <- grid.arrange(plotR, plotS, ncol=2)
# Nifedipine
source("PBPK_sim_nifedipine.R")
plot_nif <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = conc-(max_sd-conc), ymax = max_sd), width=.1) +
xlim(0,5.7) +
ylim(0,1.65) +
xlab("Time (h)") +
ylab("Plasma concentraction (mg/L)") +
ggtitle("c  Nifedipine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Neutrals ###
# Digoxin
source("PBPK_sim_digoxin.R")
plot_dig <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,6.12) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Percentage dose/L") +
ggtitle("d  Digoxin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Artemether
source("PBPK_sim_artemether.R")
plot_art <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = pmax(conc-(max_sd-conc),0), ymax = max_sd), width=.1) +
xlim(0,16.2) +
ylim(0,0.35) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("g  Artemether") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Zwitterion ###
# Ofloxacin
source("PBPK_sim_ofloxacin.R")
plot_oflo <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data=df, aes(x=time, ymin=conc-(sd_max-conc), ymax=sd_max), width=.1) +
xlim(0,25) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("e  Ofloxacin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
fig6 <- grid.arrange(plot_met, plot_vori, plot_nif, plot_dig, plot_oflo, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig6_new.png", fig6, width=8, height=12)
#figS2 <- grid.arrange(plot_caf, plot_alf, plot_mid, plot_nev, plotS, plot_art, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/figS2.png", figS2, width=8, height=12)
figS2_new <- grid.arrange(plot_caf, plot_alf, plot_mid, plot_nev, plotS, plotR, plot_art, ncol=2, nrow=4)
#ggsave(file="../deliv/figure/figS2_newer.png", figS2_new, width=8, height=16)
#########################################################################################################
#########################################################################################################
#########################################################################################################
######################################## CHUNK 6: Figure 8 ##############################################
#########################################################################################################
## This figure shows prediction ranges for representative drugs after incorporating inter-individual
## variability and uncertainty in physiological and drug-related parameters, respectively
# Voriconazole
source("Variability_sim_voriconazole.R")
fig8 <- grid.arrange(pred_PT, pred_Berez, pred_RR, pred_Schmitt, pred_pksim, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig8.png", fig8, width=8, height=12)
#########################################################################################################
#########################################################################################################
#########################################################################################################
######################################## CHUNK 7: Table 1 and Figure 7 ##################################
#########################################################################################################
## This table shows the error estimates for PK parameters (AUC and half-life) and RMSE from the model
## predictions from each drug class representative
source("PBPK_sim_voriconazole.R") # pk_vori
source("PBPK_sim_alfentanil.R")   # pk_alf
source("PBPK_sim_nevirapine.R")   # pk_nev
source("PBPK_sim_midazolam.R")    # pk_mid
source("PBPK_sim_metoprolol.R")   # pk_met
source("PBPK_sim_caffeine.R")     # pk_caf
source("PBPK_sim_thiopental.R")   # pk_thio_S and pk_thio_R
source("PBPK_sim_nifedipine.R")   # pk_nif
source("PBPK_sim_digoxin.R")      # pk_dig
source("PBPK_sim_artemether.R")   # pk_art
source("PBPK_sim_ofloxacin.R")    # pk_oflo
# Make a figure, but could also convert to table
size <- 2.5
stroke <- 0.5
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
ylim(0,18) +
xlab("") +
ylab("Relative RMSE") +
ggtitle("a  Relative RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7a
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_abline(intercept = 0, slope = 0) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
ylim(-27,26) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### Half-life
fig7c <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
scale_y_log10(limits = c(1e-2,1e5)) +
xlab("") +
ylab("Log of absolute residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
#ggsave(file="../deliv/figure/fig7_test.png", fig7, width=8, height=6)
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Metoprolol")
pk_caf_mod <- c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Caffeine")
pk_vori_mod <- c(pk_vori$RelRMSE,pk_vori$AUCerror,pk_vori$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Voriconazole")
pk_alf_mod <- c(pk_alf$RelRMSE,pk_alf$AUCerror,pk_alf$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Alfentanil")
pk_nev_mod <- c(pk_nev$RelRMSE,pk_nev$AUCerror,pk_nev$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Nevirapine")
pk_mid_mod <- c(pk_mid$RelRMSE,pk_mid$AUCerror,pk_mid$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Midazolam")
pk_thio_S_mod <- c(pk_thio_S$RelRMSE,pk_thio_S$AUCerror,pk_thio_S$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("S-Thiopental")
pk_thio_R_mod <- c(pk_thio_R$RelRMSE,pk_thio_R$AUCerror,pk_thio_R$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("R-Thiopental")
pk_nif_mod <- c(pk_nif$RelRMSE,pk_nif$AUCerror,pk_nif$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Nifedipine")
pk_dig_mod <- c(pk_dig$RelRMSE,pk_dig$AUCerror,pk_dig$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Digoxin")
pk_art_mod <- c(pk_art$RelRMSE,pk_art$AUCerror,pk_art$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Artemether")
pk_oflo_mod <- c(pk_oflo$RelRMSE,pk_oflo$AUCerror,pk_oflo$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Ofloxacin")
pk_mod <- rbind(pk_met_mod, pk_caf_mod, pk_vori_mod, pk_alf_mod, pk_nev_mod, pk_mid_mod,
pk_thio_S_mod, pk_thio_R_mod, pk_nif_mod, pk_dig_mod, pk_art_mod, pk_oflo_mod) %>%
'colnames<-'(c("PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim"))
table1 <- kable(pk_mod,"html") %>%
kable_styling(full_width=F) %>%
add_header_above(c("","Relative RMSE"=5,"AUC error"=5, "Half-life error"=5)) %>%
group_rows("Strong bases", 1, 2) %>%
group_rows("Weak bases", 3, 6) %>%
group_rows("Acids", 7, 9) %>%
group_rows("Neutrals", 10, 11) %>%
group_rows("Zwitterion", 12, 12)
#########################################################################################################
#########################################################################################################
table1
fig7
ggsave(file="../deliv/figure/fig7_test_new.png", fig7, width=8, height=6)
### Half-life
fig7c_no_log <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
xlab("") +
ylab("Residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7_no_log <- grid.arrange(fig7a, fig7b, fig7c_no_log, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_test_no_log.png", fig7_no_log, width=8, height=6)
### Half-life
fig7c_no_log <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=hlerror, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
xlab("") +
ylab("Residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7_no_log <- grid.arrange(fig7a, fig7b, fig7c_no_log, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_test_no_log.png", fig7_no_log, width=8, height=6)
### Half-life
fig7c_no_log <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=hlerror, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
ylim(-100,100) +
xlab("") +
ylab("Residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7_no_log <- grid.arrange(fig7a, fig7b, fig7c_no_log, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_test_no_log.png", fig7_no_log, width=8, height=6)
### Half-life
fig7c_no_log <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=hlerror, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
ylim(-80,80) +
xlab("") +
ylab("Residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7_no_log <- grid.arrange(fig7a, fig7b, fig7c_no_log, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_test_no_log.png", fig7_no_log, width=8, height=6)
### Half-life
fig7c_no_log <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=hlerror, shape=Method),size=size, stroke=stroke) +
geom_abline(intercept = 0, slope = 0) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
ylim(-80,80) +
xlab("") +
ylab("Residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7_no_log <- grid.arrange(fig7a, fig7b, fig7c_no_log, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_test_no_log.png", fig7_no_log, width=8, height=6)
