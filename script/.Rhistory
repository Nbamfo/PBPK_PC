quant_PT <- quant_calc(out_PT$Cplasma)
quant_Berez <- quant_calc(out_Berez$Cplasma)
quant_RR <- quant_calc(out_RR$Cplasma)
quant_Schmitt <- quant_calc(out_Schmitt$Cplasma)
quant_pksim <- quant_calc(out_pksim$Cplasma)
CV_table
# Generate the figure
th6 <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 15),
legend.position="none",
plot.title = element_text(face="bold", size=15))
pred_PT <- ggplot() +
geom_ribbon(data=quant_PT, aes(x=time_all, ymax=upper_b, ymin=lower_b), fill="grey60") +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
ylim(-0.1,8) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("a    PT") +
th6
pred_Berez <- ggplot() +
geom_ribbon(data=quant_Berez, aes(x=time_all, ymax=upper_b, ymin=lower_b), fill="grey60") +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
ylim(-0.1,8) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("b    Berez") +
th6
pred_RR <- ggplot() +
geom_ribbon(data=quant_RR, aes(x=time_all, ymax=upper_b, ymin=lower_b), fill="grey60") +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
ylim(-0.1,8) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("c    RR") +
scale_color_manual(values=c('grey60')) +
th6
pred_Schmitt <- ggplot() +
geom_ribbon(data=quant_Schmitt, aes(x=time_all, ymax=upper_b, ymin=lower_b), fill="grey60") +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
ylim(-0.1,8) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("d    Schmitt") +
scale_color_manual(values=c('grey60')) +
th6
pred_pksim <- ggplot() +
geom_ribbon(data=quant_pksim, aes(x=time_all, ymax=upper_b, ymin=lower_b), fill="grey60") +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
ylim(-0.1,8) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
ggtitle("e    PK-Sim") +
scale_color_manual(values=c('grey60')) +
th6
fig8 <- grid.arrange(pred_PT, pred_Berez, pred_RR, pred_Schmitt, pred_pksim, ncol=2, nrow=3)
ggsave(file="../deliv/figure/fig8_95_interval.jpg", fig8, width=8, height=12)
dim(PK_PT)
dim(c(PK_PT,PK_Berez))
c(PK_PT,PK_Berez)
head(c(PK_PT,PK_Berez))
head(cbind(PK_PT,PK_Berez))
dim(out_PT)
dim(out_PT$Cplasma)
head(out_PT$Cplasma)
# Store output of simulation that is used for the paper (figure 8 and CV calculations)
Cplasma_all <- cbind(out_PT$time[1:1001], out_PT$Cplasma, out_Berez$Cplasma, out_RR$Cplasma, out_Schmitt$Cplasma, out_pksim$Cplasma)
PK_all <- cbind(PK_PT, Pk_Berez, PK_RR, PK_Schmitt, PK_pksim)
PK_all <- cbind(PK_PT, PK_Berez, PK_RR, PK_Schmitt, PK_pksim)
write.csv(Cplasma_all, file = "Cplasma_all.csv")
write.csv(PK_all, file = "PK_all.csv")
# Store output of simulation that is used for the paper (figure 8 and CV calculations)
# Cplasma_all <- cbind(out_PT$time[1:1001], out_PT$Cplasma, out_Berez$Cplasma, out_RR$Cplasma, out_Schmitt$Cplasma, out_pksim$Cplasma)
# PK_all <- cbind(PK_PT, PK_Berez, PK_RR, PK_Schmitt, PK_pksim)
write.csv(Cplasma_all, file = "../data/Cplasma_all.csv")
write.csv(PK_all, file = "../data/PK_all.csv")
mrgtable
install.packages("mrgtable")
version
?mrgtable
??mrgtable
ap["mrgtable", "Depends"]
package.dependencies(mrgtable)
sig
?sig
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent RMSE") +
ggtitle("a  RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
# Make a figure, but could also convert to table
size <- 2.5
stroke <- 0.5
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent RMSE") +
ggtitle("a  RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
source("PBPK_sim_voriconazole.R") # pk_vori
source("PBPK_sim_alfentanil.R")   # pk_alf
source("PBPK_sim_nevirapine.R")   # pk_nev
source("PBPK_sim_midazolam.R")    # pk_mid
source("PBPK_sim_metoprolol.R")   # pk_met
source("PBPK_sim_caffeine.R")     # pk_caf
source("PBPK_sim_thiopental.R")   # pk_thio_S and pk_thio_R
source("PBPK_sim_nifedipine.R")   # pk_nif
source("PBPK_sim_digoxin.R")      # pk_dig
source("PBPK_sim_artemether.R")   # pk_art
source("PBPK_sim_ofloxacin.R")    # pk_oflo
# Make a figure, but could also convert to table
size <- 2.5
stroke <- 0.5
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent error") +
ggtitle("a  RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
# Theme 7 used for Fig. 7
th7 <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),text = element_text(size = 10),
legend.justification=c(1,1), legend.position=c(1,1), legend.key=element_blank(), legend.title = element_blank(),
axis.text.x = element_text(angle = 90, hjust = 1),plot.title = element_text(face="bold", size=15))
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent error") +
ggtitle("a  RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7a
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
#ylim(0, 4200) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### Half-life (semi-log plot)
fig7c <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Percent error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7c
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7.png", fig7, width=8, height=6)
?signif
?formatC
?grepl
?gsub
sig(2.11111)
source("sig.R")
sig(2.11111)
sig(2.11195)
sig(2.1195)
sig(2.1194)
sig(2.09)
sig(2.091)
sig(2.095)
pk_avg
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Metoprolol")
pk_met_mod
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
'rownames<-'("Metoprolol")
sig(pk_met$RelRMSE)
pk_met$RelRMSE
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
as.data.frame() %>%
'rownames<-'("Metoprolol")
c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
as.data.frame()
c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror)
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
as.matrix() %>%
'rownames<-'("Metoprolol")
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
as.matrix()
dim(pk_met_mod)
pk_met_mod
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
sig() %>%
as.matrix()
pk_met_mod
dim(pk_met_mod)
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
sig() %>%
as.matrix() %>%
t() %>%
'rownames<-'("Metoprolol")
pk_met_mod
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Metoprolol")
pk_met_mod
dim(pk_met_mod)
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
sig() %>%
'rownames<-'("Metoprolol")
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Metoprolol")
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Metoprolol")
pk_caf_mod <- c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Caffeine")
pk_vori_mod <- c(pk_vori$RelRMSE,pk_vori$AUCerror,pk_vori$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Voriconazole")
pk_alf_mod <- c(pk_alf$RelRMSE,pk_alf$AUCerror,pk_alf$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Alfentanil")
pk_nev_mod <- c(pk_nev$RelRMSE,pk_nev$AUCerror,pk_nev$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Nevirapine")
pk_mid_mod <- c(pk_mid$RelRMSE,pk_mid$AUCerror,pk_mid$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Midazolam")
pk_thio_S_mod <- c(pk_thio_S$RelRMSE,pk_thio_S$AUCerror,pk_thio_S$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("S-Thiopental")
pk_thio_R_mod <- c(pk_thio_R$RelRMSE,pk_thio_R$AUCerror,pk_thio_R$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("R-Thiopental")
pk_nif_mod <- c(pk_nif$RelRMSE,pk_nif$AUCerror,pk_nif$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Nifedipine")
pk_dig_mod <- c(pk_dig$RelRMSE,pk_dig$AUCerror,pk_dig$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Digoxin")
pk_art_mod <- c(pk_art$RelRMSE,pk_art$AUCerror,pk_art$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Artemether")
pk_oflo_mod <- c(pk_oflo$RelRMSE,pk_oflo$AUCerror,pk_oflo$hlerror) %>%
sig() %>%
t() %>%
'rownames<-'("Ofloxacin")
pk_mod <- rbind(pk_met_mod, pk_caf_mod, pk_vori_mod, pk_alf_mod, pk_nev_mod, pk_mid_mod,
pk_thio_S_mod, pk_thio_R_mod, pk_nif_mod, pk_dig_mod, pk_art_mod, pk_oflo_mod)
pk_mod
sig(pk_mod)
# Include row of average values for each method (over all drugs)
pk_avg <-  colMeans(pk_mod) %>%
sig() %>%
t() %>%
'rownames<-'("Mean")
pk_mod
colMeans(as.numeric(pk_mod))
as.numeric(pk_mod)
as.matrix(pk_mod)
as.matrix(as.numeric(pk_mod))
# Include row of average values for each method (over all drugs)
pk_mod_new <- rbind(c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror), c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror))
pk_mod_new
colMeans(pk_mod_new)
sig(colMeans(pk_mod_new))
# Include row of average values for each method (over all drugs)
pk_mod_new <- rbind(c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror), c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror),
c(pk_vori$RelRMSE,pk_vori$AUCerror,pk_vori$hlerror), c(pk_alf$RelRMSE,pk_alf$AUCerror,pk_alf$hlerror),
c(pk_nev$RelRMSE,pk_nev$AUCerror,pk_nev$hlerror), c(pk_mid$RelRMSE,pk_mid$AUCerror,pk_mid$hlerror),
c(pk_thio_S$RelRMSE,pk_thio_S$AUCerror,pk_thio_S$hlerror), c(pk_thio_R$RelRMSE,pk_thio_R$AUCerror,pk_thio_R$hlerror),
c(pk_nif$RelRMSE,pk_nif$AUCerror,pk_nif$hlerror), c(pk_dig$RelRMSE,pk_dig$AUCerror,pk_dig$hlerror),
c(pk_art$RelRMSE,pk_art$AUCerror,pk_art$hlerror), c(pk_oflo$RelRMSE,pk_oflo$AUCerror,pk_oflo$hlerror))
pk_avg <-  colMeans(pk_mod) %>%
sig() %>%
t() %>%
'rownames<-'("Mean")
pk_avg <-  colMeans(pk_mod_new) %>%
sig() %>%
t() %>%
'rownames<-'("Mean")
pk_avg
# Include row of average values for each method (over all drugs)
pk_mod_avg <- rbind(c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror), c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror),
c(pk_vori$RelRMSE,pk_vori$AUCerror,pk_vori$hlerror), c(pk_alf$RelRMSE,pk_alf$AUCerror,pk_alf$hlerror),
c(pk_nev$RelRMSE,pk_nev$AUCerror,pk_nev$hlerror), c(pk_mid$RelRMSE,pk_mid$AUCerror,pk_mid$hlerror),
c(pk_thio_S$RelRMSE,pk_thio_S$AUCerror,pk_thio_S$hlerror), c(pk_thio_R$RelRMSE,pk_thio_R$AUCerror,pk_thio_R$hlerror),
c(pk_nif$RelRMSE,pk_nif$AUCerror,pk_nif$hlerror), c(pk_dig$RelRMSE,pk_dig$AUCerror,pk_dig$hlerror),
c(pk_art$RelRMSE,pk_art$AUCerror,pk_art$hlerror), c(pk_oflo$RelRMSE,pk_oflo$AUCerror,pk_oflo$hlerror))
pk_avg <-  colMeans(pk_mod_avg) %>%
sig() %>%
t() %>%
'rownames<-'("Mean")
pk_mod_all <- rbind(pk_mod, pk_avg) %>%
'colnames<-'(c("PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim"))
table1 <- kable(pk_mod_all,"html") %>%
kable_styling(full_width=F) %>%
add_header_above(c("","Relative percent RMSE"=5,"AUC percent error"=5, "Half-life percent error"=5)) %>%
group_rows("Strong bases", 1, 2) %>%
group_rows("Weak bases", 3, 6) %>%
group_rows("Acids", 7, 9) %>%
group_rows("Neutrals", 10, 11) %>%
group_rows("Zwitterion", 12, 12)
table1
CV_all
CV_all <- rbind(CV_PT, CV_Berez, CV_RR, CV_Schmitt, CV_pksim) %>%
sig() %>%
'colnames<-' (c("AUC CV", "Cmax CV")) %>%
'rownames<-' (c("PT", "Berez", "RR", "Schmitt", "pksim"))
rbind(CV_PT, CV_Berez, CV_RR, CV_Schmitt, CV_pksim)
rbind(CV_PT, CV_Berez, CV_RR, CV_Schmitt, CV_pksim) %>%
sig()
# Calculate the percent coefficient of variation for AUC and Cmax values for each method
CV_calc <- function(x){
CV <- (sd(x) / mean(x))*100 %>%
sig()
return(CV)
}
CV_PT <- c(CV_calc(PK_PT[,1]), CV_calc(PK_PT[,2]))
# Calculate the percent coefficient of variation for AUC and Cmax values for each method
CV_calc <- function(x){
CV <- (sd(x) / mean(x))*100
return(CV)
}
CV_PT <- c(CV_calc(PK_PT[,1]), CV_calc(PK_PT[,2]))
CV_PT
sig(CV_PT)
dim(CV_PT)
dim(sig(CV_PT))
# Calculate the percent coefficient of variation for AUC and Cmax values for each method
CV_calc <- function(x){
CV <- sig((sd(x) / mean(x))*100)
return(CV)
}
CV_PT <- c(CV_calc(PK_PT[,1]), CV_calc(PK_PT[,2]))
CV_PT
CV_all <- rbind(CV_PT, CV_Berez, CV_RR, CV_Schmitt, CV_pksim) %>%
'colnames<-' (c("AUC CV", "Cmax CV")) %>%
'rownames<-' (c("PT", "Berez", "RR", "Schmitt", "pksim"))
CV_table <- kable(CV_all,"html") %>%
kable_styling(full_width=F)
CV_table
CV_Berez <- c(CV_calc(PK_Berez[,1]), CV_calc(PK_Berez[,2]))
CV_RR <- c(CV_calc(PK_RR[,1]), CV_calc(PK_RR[,2]))
CV_Schmitt <- c(CV_calc(PK_Schmitt[,1]), CV_calc(PK_Schmitt[,2]))
CV_pksim <- c(CV_calc(PK_pksim[,1]), CV_calc(PK_pksim[,2]))
CV_all <- rbind(CV_PT, CV_Berez, CV_RR, CV_Schmitt, CV_pksim) %>%
'colnames<-' (c("AUC CV", "Cmax CV")) %>%
'rownames<-' (c("PT", "Berez", "RR", "Schmitt", "pksim"))
CV_table <- kable(CV_all,"html") %>%
kable_styling(full_width=F)
CV_table
table1
