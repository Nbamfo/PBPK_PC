scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_abline(intercept = 0, slope = 0) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
ylim(0, 100) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_abline(intercept = 0, slope = 0) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
ylim(0, 1000) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
ylim(0, 2000) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
pk_nif
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
ylim(0, 4200) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
pk_nif
### Half-life (semi-log plot)
fig7c <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
scale_y_log10(limits = c(1e-2,1e5)) +
xlab("") +
ylab("Log of absolute residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7c
10^5
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
#ylim(0, 4200) +
scale_y_log10(limits = c(1e-2,1e5)) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_new_error.png", fig7_no_log, width=8, height=6)
ggsave(file="../deliv/figure/fig7_new_error.png", fig7, width=8, height=6)
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
#ylim(0, 4200) +
scale_y_log10(limits = c(1e-2,1e6)) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
fig7c <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
scale_y_log10(limits = c(1e-2,1e5)) +
xlab("") +
ylab("Log of absolute residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7c
ggsave(file="../deliv/figure/fig7_new_error.png", fig7, width=8, height=6)
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
#ylim(0, 4200) +
scale_y_log10(limits = c(1e-2,1e6)) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_new_error.png", fig7, width=8, height=6)
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-2,1e4)) +
xlab("") +
ylab("Relative RMSE") +
ggtitle("a  Relative RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7a
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-2,1e6)) +
xlab("") +
ylab("Relative RMSE") +
ggtitle("a  Relative RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7a
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_new_error.png", fig7, width=8, height=6)
# RelRMSE = scale the root mean square error by the range of the observations
fig7a <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=RelRMSE, shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(0,18) + #Using error
#ylim(0, 1500) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Relative RMSE") +
ggtitle("a  Relative RMSE") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7a
### AUC error
fig7b <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=AUCerror, shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=AUCerror, shape=Method),size=size, stroke=stroke) +
#geom_abline(intercept = 0, slope = 0) + # Using error
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
#ylim(-27,26) + #Using error
#ylim(0, 4200) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Residual error") +
ggtitle("b  AUC error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7b
### Half-life (semi-log plot)
fig7c <- ggplot() +
geom_point(data=pk_met, aes(x=1, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_caf, aes(x=2, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_vori, aes(x=4, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_alf, aes(x=5, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nev, aes(x=6, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_mid, aes(x=7, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_S, aes(x=9, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_thio_R, aes(x=10, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_nif, aes(x=11, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_dig, aes(x=13, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_art, aes(x=14, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
geom_point(data=pk_oflo, aes(x=16, y=abs(hlerror), shape=Method),size=size, stroke=stroke) +
scale_x_continuous(breaks=c(1,2,4,5,6,7,9,10,11,13,14,16),
labels = c("Metoprolol","Caffeine","Voriconazole","Alfentanil",
"Nevirapine","Midazolam","S-Thiopental","R-Thiopental",
"Nifedipine","Digoxin","Artemether","Ofloxacin")) +
scale_y_log10(limits = c(1e-1,1e6)) +
xlab("") +
ylab("Log of absolute residual error") +
ggtitle("c  Half-life error") +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
th7
fig7c
fig7 <- grid.arrange(fig7a, fig7b, fig7c, ncol=3, nrow=1)
ggsave(file="../deliv/figure/fig7_new_error.png", fig7, width=8, height=6)
### Generate table (drugs in the rows, columns of RMSE, AUC, and half-life error)
pk_met_mod <- c(pk_met$RelRMSE,pk_met$AUCerror,pk_met$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Metoprolol")
pk_caf_mod <- c(pk_caf$RelRMSE,pk_caf$AUCerror,pk_caf$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Caffeine")
pk_vori_mod <- c(pk_vori$RelRMSE,pk_vori$AUCerror,pk_vori$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Voriconazole")
pk_alf_mod <- c(pk_alf$RelRMSE,pk_alf$AUCerror,pk_alf$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Alfentanil")
pk_nev_mod <- c(pk_nev$RelRMSE,pk_nev$AUCerror,pk_nev$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Nevirapine")
pk_mid_mod <- c(pk_mid$RelRMSE,pk_mid$AUCerror,pk_mid$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Midazolam")
pk_thio_S_mod <- c(pk_thio_S$RelRMSE,pk_thio_S$AUCerror,pk_thio_S$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("S-Thiopental")
pk_thio_R_mod <- c(pk_thio_R$RelRMSE,pk_thio_R$AUCerror,pk_thio_R$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("R-Thiopental")
pk_nif_mod <- c(pk_nif$RelRMSE,pk_nif$AUCerror,pk_nif$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Nifedipine")
pk_dig_mod <- c(pk_dig$RelRMSE,pk_dig$AUCerror,pk_dig$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Digoxin")
pk_art_mod <- c(pk_art$RelRMSE,pk_art$AUCerror,pk_art$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Artemether")
pk_oflo_mod <- c(pk_oflo$RelRMSE,pk_oflo$AUCerror,pk_oflo$hlerror) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Ofloxacin")
pk_mod <- rbind(pk_met_mod, pk_caf_mod, pk_vori_mod, pk_alf_mod, pk_nev_mod, pk_mid_mod,
pk_thio_S_mod, pk_thio_R_mod, pk_nif_mod, pk_dig_mod, pk_art_mod, pk_oflo_mod) %>%
'colnames<-'(c("PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim"))
table1 <- kable(pk_mod,"html") %>%
kable_styling(full_width=F) %>%
add_header_above(c("","Relative RMSE"=5,"AUC error"=5, "Half-life error"=5)) %>%
group_rows("Strong bases", 1, 2) %>%
group_rows("Weak bases", 3, 6) %>%
group_rows("Acids", 7, 9) %>%
group_rows("Neutrals", 10, 11) %>%
group_rows("Zwitterion", 12, 12)
table1
pk_oflo_mod
pk_mod[:,1]
pk_mod[,1]
sum(pk_mod[,1])
mean(pk_mod[,1])
mean(pk_mod[,])
colMeans(pk_mod[,])
colMeans(pk_mod)
# Include row of average values for each method (over all drugs)
pk_avg <- colMeans(pk_mod)%>%
'rownames<-'("Mean")
dim(pk_avg)
pk_avg <- colMeans(pk_mod)
pk_avg <- colMeans(pk_mod)
dim(pk_avg)
pk_avg[1]
pk_mod <- rbind(pk_met_mod, pk_caf_mod, pk_vori_mod, pk_alf_mod, pk_nev_mod, pk_mid_mod,
pk_thio_S_mod, pk_thio_R_mod, pk_nif_mod, pk_dig_mod, pk_art_mod, pk_oflo_mod)
# Include row of average values for each method (over all drugs)
pk_avg <- colMeans(pk_mod)%>%
'rownames<-'("Mean")
# Include row of average values for each method (over all drugs)
pk_avg <- c(colMeans(pk_mod)) %>%
'rownames<-'("Mean")
# Include row of average values for each method (over all drugs)
pk_avg <- as.matrix(colMeans(pk_mod)) %>%
'rownames<-'("Mean")
colMeans(pk_mod)
dim(colMeans(pk_mod))
t(colMeans(pk_mod))
dim(t(colMeans(pk_mod)))
# Include row of average values for each method (over all drugs)
pk_avg <-  dim(t(colMeans(pk_mod))) %>%
'rownames<-'("Mean")
# Include row of average values for each method (over all drugs)
pk_avg <-  t(colMeans(pk_mod)) %>%
'rownames<-'("Mean")
pk_avg
pk_mod_all <- rbind(pk_mod, pk_avg) %>%
'colnames<-'(c("PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim",
"PT","Berez","RR","Schmitt","PK-Sim"))
table1 <- kable(pk_mod_all,"html") %>%
kable_styling(full_width=F) %>%
add_header_above(c("","Relative RMSE"=5,"AUC error"=5, "Half-life error"=5)) %>%
group_rows("Strong bases", 1, 2) %>%
group_rows("Weak bases", 3, 6) %>%
group_rows("Acids", 7, 9) %>%
group_rows("Neutrals", 10, 11) %>%
group_rows("Zwitterion", 12, 12)
table1
# Include row of average values for each method (over all drugs)
pk_avg <-  colMeans(pk_mod) %>%
t() %>%
round(digits=3) %>%
'rownames<-'("Mean")
pk_avg
