#ggsave(file="../deliv/figure/fig4.png", fig4, width=8, height=12)
fig4_test <- grid.arrange(fig4a, fig4b, fig4c, fig4d, fig4e, ncol=5, nrow=1)
ggsave(file="../deliv/figure/fig4_test.pdf", fig4_test, width=20, height=4)
drug_pred <- function(logP, pKa, fup, BP, type, dat_uni, dat_method, method){
if(method=="P&T"){
uni <- calcKp_PT(logP, pKa, fup, BP, type, dat_uni)        #prediction using unified tissue composition
pred <- calcKp_PT(logP, pKa, fup, BP, type, dat_method)    #prediction using reported tissue composition
pred <- c(pred[1:3], pred[5:6], pred[4], pred[7:9], pred[11], pred[10])
}
else if(method=="Berezhkovskiy"){
uni <- calcKp_Berez(logP, pKa, fup, BP, type, dat_uni)     #prediction using unified tissue composition
pred <- calcKp_Berez(logP, pKa, fup, BP, type, dat_method) #prediction using reported tissue composition
pred <- c(pred[1:3], pred[5:6], pred[4], pred[7:9], pred[11], pred[10])
}
else if(method=="R&R"){
uni <- calcKp_RR(logP, pKa, fup, BP, type, dat_uni)        #prediction using unified tissue composition
pred <- calcKp_RR(logP, pKa, fup, BP, type, dat_method)    #prediction using reported tissue composition
pred <- c(pred[1:3],pred[5:6],pred[4],pred[7:9],pred[11:12])
}
else if(method=="Schmitt"){
uni <- calcKp_Schmitt(logP, pKa, fup, type, dat_uni)       #prediction using unified tissue composition
pred <- calcKp_Schmitt(logP, pKa, fup, type, dat_method)   #prediction using PK-Sim reported tissue composition
pred <- c(pred[3], pred[1:2], pred[4:6], pred[9:11], pred[13:14])
}
else if(method=="Schmitt2"){
uni <- calcKp_Schmitt(logP, pKa, fup, type, dat_uni)       #prediction using unified tissue composition
pred <- calcKp_Schmitt(logP, pKa, fup, type, dat_method)   #prediction using reported tissue composition
pred <- c(pred[1:3], pred[5:6], pred[4],pred[7:11])
}
else if(method=="PK-Sim"){
uni <- calcKp_pksim(logP, fup, dat_uni)                    #prediction using unified tissue composition
pred <- calcKp_pksim(logP, fup, dat_method)                #prediction using reported tissue composition
pred <- c(pred[3], pred[1:2], pred[4:6], pred[9:11], pred[13:14])
}
drug_vals <- data.frame(uni_pred = unlist(uni),pred = unlist(pred))
return(drug_vals)
}
# Define location of Pearson correlation coef. on every plot (fraction of maximum x and y value f plot)
pcc_x <- 0.75
pcc_y <- 0.35
# Poulin and Theil method
# uni output order: adipose, bone, brain, heart, kidney, gut, liver, lung, muscle, skin, spleen
# pred output order: adipose, bone, brain, gut, heart, kidney, liver, lung, muscle, spleen, skin
### Strong Base ###
#Metoprolol
met <- drug_pred(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace <- drug_pred(1.4, 9.7, 0.79, BP=1, type=3, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori <- drug_pred(2.56, 1.76, 0.42, BP=1, type=3, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp <- drug_pred(2.5, 2.4, 0.35, BP=1, type=3, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio <- drug_pred(2.9, 7.5, 0.13, BP=1, type=2, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen <- drug_pred(0.8, 7.35, 0.78, BP=1, type=2, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig <- drug_pred(1.48, 0, 0.87, BP=1, type=1, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho <- drug_pred(0.77, 0, 0.5, BP=1, type=1, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo <- drug_pred(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno <- drug_pred(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_uni, dat_PT, "P&T") %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_PT <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_PT <- round(cor(drug_all_PT$uni_pred,drug_all_PT$pred,method='pearson'), digits=2)
corr_coeff_PT <- paste("italic(r) %~~%", corr_coeff_PT)
fig4a <- ggplot() +
geom_point(data=drug_all_PT, aes(x=uni_pred, y=pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_PT[1:2])) +
ylim(0,max(drug_all_PT[1:2])) +
#xlab("Predicted Kp (standardized tissue composition)") +
xlab("Predicted Kp (unified tissue composition)") +
ylab("Predicted Kp (reported tissue composition)") +
#ggtitle("a    PT") +
ggtitle("PT") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_PT[1:2])*pcc_x, y=max(drug_all_PT[1:2])*pcc_y, label=corr_coeff_PT), parse=TRUE)
# Berezkovskiy method
# uni output order: adipose, bone, brain, heart, kidney, gut, liver, lung, muscle, skin, spleen
# pred output order: adipose, bone, brain, gut, heart, kidney, liver, lung, muscle, spleen, skin
# We use dat_PT as the reported tissue composition because Berezkovskiy uses the same tissue composition as Poulin and Theil
### Strong Base ###
#Metoprolol
met <- drug_pred(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace <- drug_pred(1.4, 9.7, 0.79, BP=1, type=3, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori <- drug_pred(2.56, 1.76, 0.42, BP=1, type=3, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp <- drug_pred(2.5, 2.4, 0.35, BP=1, type=3, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio <- drug_pred(2.9, 7.5, 0.13, BP=1, type=2, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen <- drug_pred(0.8, 7.35, 0.78, BP=1, type=2, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig <- drug_pred(1.48, 0, 0.87, BP=1, type=1, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho <- drug_pred(0.77, 0, 0.5, BP=1, type=1, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo <- drug_pred(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno <- drug_pred(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_uni, dat_PT, "Berezhkovskiy") %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_Berez <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_Berez <- round(cor(drug_all_Berez$uni_pred,drug_all_Berez$pred,method='pearson'),digits=2)
corr_coeff_Berez <- paste("italic(r) %~~%", corr_coeff_Berez)
fig4b <- ggplot() +
geom_point(data=drug_all_Berez, aes(x=uni_pred, y=pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_Berez[1:2])) +
ylim(0,max(drug_all_Berez[1:2])) +
#xlab("Predicted Kp (standardized tissue composition)") +
xlab("Predicted Kp (unified tissue composition)") +
ylab("Predicted Kp (reported tissue composition)") +
#ggtitle("b    Berez") +
ggtitle("Berez") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_Berez[1:2])*pcc_x, y=max(drug_all_Berez[1:2])*pcc_y, label=corr_coeff_Berez), parse=TRUE)
# Rodgers and Rowland method
# uni output order: adipose, bone, brain, heart, kidney, gut, liver, lung, muscle, skin, spleen
# pred output order: adipose, bone, brain, gut, heart, kidney liver, lung, muscle, pancreas, skin, spleen, thymus
### Strong Base ###
#Metoprolol
met <- drug_pred(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace <- drug_pred(1.4, 9.7, 0.79, BP=1, type=3, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori <- drug_pred(2.56, 1.76, 0.42, BP=1, type=3, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp <- drug_pred(2.5, 2.4, 0.35, BP=1, type=3, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio <- drug_pred(2.9, 7.5, 0.13, BP=1, type=2, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen <- drug_pred(0.8, 7.35, 0.78, BP=1, type=2, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig <- drug_pred(1.48, 0, 0.87, BP=1, type=1, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho <- drug_pred(0.77, 0, 0.5, BP=1, type=1, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo <- drug_pred(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Zwitterion")
# Enoxacin
eno <- drug_pred(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_uni, dat_RR, "R&R") %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_RR <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_RR <- round(cor(drug_all_RR$uni_pred,drug_all_RR$pred,method='pearson'), digits=2)
corr_coeff_RR <- paste("italic(r) %~~%", corr_coeff_RR)
fig4c <- ggplot() +
geom_point(data=drug_all_RR, aes(x=uni_pred, y=pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_RR[1:2])) +
ylim(0,max(drug_all_RR[1:2])) +
#xlab("Predicted Kp (standardized tissue composition)") +
xlab("Predicted Kp (unified tissue composition)") +
ylab("Predicted Kp (reported tissue composition)") +
#ggtitle("c   RR") +
ggtitle("RR") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_RR[1:2])*pcc_x, y=max(drug_all_RR[1:2])*pcc_y, label=corr_coeff_RR), parse=TRUE)
# Schmitt method
# uni output order: adipose, bone, brain, heart, kidney, gut, liver, lung, muscle, skin, spleen
# pred output order: adipose, bone, brain, gut, heart, kidney, liver, lung, muscle, skin, spleen, testes, RBCs
### Strong Base ###
# Metoprolol
met <- drug_pred(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace <- drug_pred(1.4, 9.7, 0.79, BP=1, type=3, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori <- drug_pred(2.56, 1.76, 0.42, BP=1, type=3, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp <- drug_pred(2.5, 2.4, 0.35, BP=1, type=3, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio <- drug_pred(2.9, 7.5, 0.13, BP=1, type=2, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen <- drug_pred(0.8, 7.35, 0.78, BP=1, type=2, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig <- drug_pred(1.48, 0, 0.87, BP=1, type=1, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho <- drug_pred(0.77, 0, 0.5, BP=1, type=1, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo <- drug_pred(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Zwitterion")
#Enoxacin
eno <- drug_pred(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_uni, dat_Schmitt, "Schmitt") %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_schmitt <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_Schmitt <- round(cor(drug_all_schmitt$uni_pred,drug_all_schmitt$pred,method='pearson'), digits=2)
corr_coeff_Schmitt <- paste("italic(r) %~~%", corr_coeff_Schmitt)
fig4d <- ggplot() +
geom_point(data=drug_all_schmitt, aes(x=uni_pred, y=pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_schmitt[1:2])) +
ylim(0,max(drug_all_schmitt[1:2])) +
#xlab("Predicted Kp (standardized tissue composition)") +
xlab("Predicted Kp (unified tissue composition)") +
ylab("Predicted Kp (reported tissue composition)") +
#ggtitle("d   Schmitt") +
ggtitle("Schmitt") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_schmitt[1:2])*pcc_x, y=max(drug_all_schmitt[1:2])*pcc_y, label=corr_coeff_Schmitt), parse=TRUE)
#PK-Sim standard method
# uni output order: adipose, bone, brain, heart, kidney, gut, liver, lung, muscle, skin, spleen
# pred output order: bone, brain, adipose, heart, kidney, stomach, small intestine, large intestine, liver, lung, muscle, pancreas, skin, spleen
### Strong Base ###
# Metoprolol
met <- drug_pred(2.15, 9.7, 0.8, BP=1.52, type=3, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Strong base")
# Acebutolol-R
ace <- drug_pred(1.4, 9.7, 0.79, BP=1, type=3, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Strong base")
### Weak Base ###
# Voriconazole
vori <- drug_pred(2.56, 1.76, 0.42, BP=1, type=3, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Weak base")
#Alprazolam
alp <- drug_pred(2.5, 2.4, 0.35, BP=1, type=3, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Weak base")
### Acid ###
# Thiopental
thio <- drug_pred(2.9, 7.5, 0.13, BP=1, type=2, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Acid")
# Phenobarbital
phen <- drug_pred(0.8, 7.35, 0.78, BP=1, type=2, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Acid")
### Neutral ###
# Digoxin
dig <- drug_pred(1.48, 0, 0.87, BP=1, type=1, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Neutral")
# Ethoxybenzamide
etho <- drug_pred(0.77, 0, 0.5, BP=1, type=1, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Neutral")
### Zwitterion ###
# Ofloxacin
oflo <- drug_pred(-0.4, c(5.97,9.28), 0.77, BP=0.92, type=6, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Zwitterion")
# Enoxacin
eno <- drug_pred(0.1, c(6.1,8.7), 0.66, BP=0.94, type=6, dat_uni, dat_pksim, "PK-Sim") %>%
mutate(Drug_class = "Zwitterion")
# Bind all the outputs together
drug_all_pksim <- rbind(met,ace,vori,alp,thio,phen,dig,etho,oflo,eno)
# Calculate the Pearson correlation coefficient
corr_coeff_pksim <- round(cor(drug_all_pksim$uni_pred,drug_all_pksim$pred,method='pearson'), digits=2)
corr_coeff_pksim <- paste("italic(r) %~~%", corr_coeff_pksim)
fig4e <- ggplot() +
geom_point(data=drug_all_pksim, aes(x=uni_pred, y=pred, shape=Drug_class), size=3) +
scale_shape_discrete(solid=F) +
geom_abline(intercept = 0, slope = 1) +
xlim(0,max(drug_all_pksim[1:2])) +
ylim(0,max(drug_all_pksim[1:2])) +
#xlab("Predicted Kp (standardized tissue composition)") +
xlab("Predicted Kp (unified tissue composition)") +
ylab("Predicted Kp (reported tissue composition)") +
#ggtitle("e   PK-Sim") +
ggtitle("PK-Sim") +
theme(legend.title =  element_blank()) +
th1 +
geom_text(aes(x=max(drug_all_pksim[1:2])*pcc_x, y=max(drug_all_pksim[1:2])*pcc_y, label=corr_coeff_pksim), parse=TRUE)
fig4 <- grid.arrange(fig4a, fig4b, fig4c, fig4d, fig4e, ncol=2, nrow=3)
#ggsave(file="../deliv/figure/fig4.png", fig4, width=8, height=12)
fig4_test <- grid.arrange(fig4a, fig4b, fig4c, fig4d, fig4e, ncol=5, nrow=1)
ggsave(file="../deliv/figure/fig4_test.pdf", fig4_test, width=20, height=4)
### Strong bases ###
# Metoprolol
source("PBPK_sim_metoprolol.R")
plot_met <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=mean), size=2) +
geom_errorbar(data=df, aes(x=time, ymin=mean-sd, ymax=mean+sd), width=.1) +
xlim(0,13) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("a  Metoprolol") +
ggtitle("Metoprolol") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Weak bases ###
# Voriconazole
source("PBPK_sim_voriconazole.R")
plot_vori <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("b  Voriconazole") +
ggtitle("Voriconazole") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Nifedipine
source("PBPK_sim_nifedipine.R")
plot_nif <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = conc-(max_sd-conc), ymax = max_sd), width=.1) +
xlim(0,5.7) +
ylim(0,1.65) +
xlab("Time (h)") +
ylab("Plasma concentraction (mg/L)") +
#ggtitle("c  Nifedipine") +
ggtitle("Nifedipine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Neutrals ###
# Digoxin
source("PBPK_sim_digoxin.R")
plot_dig <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,6.12) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Percentage dose/L") +
#ggtitle("d  Digoxin") +
ggtitle("Digoxin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Zwitterion ###
# Ofloxacin
source("PBPK_sim_ofloxacin.R")
plot_oflo <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data=df, aes(x=time, ymin=conc-(sd_max-conc), ymax=sd_max), width=.1) +
xlim(0,25) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("e  Ofloxacin") +
ggtitle("Ofloxacin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
fig6_test <- grid.arrange(plot_met, plot_vori, plot_nif, plot_dig, plot_oflo, ncol=5, nrow=1)
ggsave(file="../deliv/figure/fig6_poster_test.pdf", fig6_test, width=20, height=4)
# Theme 6 used for Fig. 6
th6 <- theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"), text = element_text(size = 10),
legend.justification=c(1,1), legend.position=c(1,1.05), legend.key=element_blank(),
plot.title = element_text(face="bold", size=15, hjust = 0.5))
### Strong bases ###
# Metoprolol
source("PBPK_sim_metoprolol.R")
plot_met <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=mean), size=2) +
geom_errorbar(data=df, aes(x=time, ymin=mean-sd, ymax=mean+sd), width=.1) +
xlim(0,13) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("a  Metoprolol") +
ggtitle("Metoprolol") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
plot_met
### Weak bases ###
# Voriconazole
source("PBPK_sim_voriconazole.R")
plot_vori <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data = df, aes(x = time, ymin=conc-sd, ymax=conc+sd), width=0.1) +
xlim(-0.1,10.1) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("b  Voriconazole") +
ggtitle("Voriconazole") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
# Nifedipine
source("PBPK_sim_nifedipine.R")
plot_nif <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data = df, aes(time, conc), size=2.5) +
geom_errorbar(data = df, aes(time, ymin = conc-(max_sd-conc), ymax = max_sd), width=.1) +
xlim(0,5.7) +
ylim(0,1.65) +
xlab("Time (h)") +
ylab("Plasma concentraction (mg/L)") +
#ggtitle("c  Nifedipine") +
ggtitle("Nifedipine") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Neutrals ###
# Digoxin
source("PBPK_sim_digoxin.R")
plot_dig <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
xlim(0,6.12) +
scale_y_log10() +
xlab("Time (h)") +
ylab("Percentage dose/L") +
#ggtitle("d  Digoxin") +
ggtitle("Digoxin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
### Zwitterion ###
# Ofloxacin
source("PBPK_sim_ofloxacin.R")
plot_oflo <- ggplot() +
geom_line(data=out_all,aes(x=time, y=Cplasma, linetype=Method, color=Method)) +
geom_point(data=out_reduced,aes(x=time, y=Cplasma, shape=Method),size=2, stroke=0.6) +
geom_point(data=df, aes(x=time, y=conc), size=2.5) +
geom_errorbar(data=df, aes(x=time, ymin=conc-(sd_max-conc), ymax=sd_max), width=.1) +
xlim(0,25) +
xlab("Time (h)") +
ylab("Plasma concentration (mg/L)") +
#ggtitle("e  Ofloxacin") +
ggtitle("Ofloxacin") +
scale_linetype_manual("", values=c(1,1,1,1,1,1,1)) +
scale_shape_manual("", values=c(0,2,3,4,5,8)) +
scale_color_manual("", values=c('grey60','grey60','grey60','grey60','grey60','grey60')) +
th6
fig6_test <- grid.arrange(plot_met, plot_vori, plot_nif, plot_dig, plot_oflo, ncol=5, nrow=1)
ggsave(file="../deliv/figure/fig6_poster_test.pdf", fig6_test, width=20, height=4)
